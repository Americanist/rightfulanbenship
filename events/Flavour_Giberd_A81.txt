# Giberd MT events
# 1-9: old events
# 10-19: mission flavour events
# 20-29: electorate event chain
# 30-39: artificer faction events
namespace = flavor_giberd
# Reworked Giberd MT events
#Our Options of War
country_event = {
	id = flavor_giberd.10
	title = flavor_giberd.10.t
	desc = flavor_giberd.10.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	immediate = {
		# TODO: inability to research
		hidden_effect = {
			#Artificery Local Setup
			set_country_flag = artificery_unlocked			#failsave
			artifice_inventions_give_basket = yes
			update_artifice_points = yes
			clear_artificers_organization_effect = yes
			set_estate_privilege = estate_artificers_organization_giberd_magisterium_oversight
			bennonhill_area = {
				add_permanent_claim = ROOT
			}
			hearthswood_area = {
				add_permanent_claim = ROOT
			}
		}
	}
	option = {
		name = flavor_giberd.10.a
		goto = 273		#Tendergrove
		add_country_modifier = {
			name = giberd_options_war_leslinpar
			duration = 3560
		}
		add_treasury = -50
		random_owned_province = {
			limit = {
				infantry_in_province = 2
				infantry_in_province = ROOT
			}
			kill_units = {
				who = owner
				type = infantry
				amount = 2
			}
			rajput_infantry = ROOT
			rajput_infantry = ROOT
		}
		custom_tooltip = giberd_unable_to_research_10
		custom_tooltip = giberd_ae_gnomish_minority_tt
		custom_tooltip = giberd_magisterium_oversight_tt
		custom_tooltip = has_already_happened_tt
		tooltip = {
			bennonhill_area = {
				add_permanent_claim = ROOT
			}
			hearthswood_area = {
				add_permanent_claim = ROOT
			}
		}
		set_estate_privilege = estate_artificers_organization_giberd_magisterium_oversight
	}
	option = {
		name = flavor_giberd.10.b
		goto = 268		#Bennon
		custom_tooltip = giberd_bennon_forts_explode_tt
		tooltip = {
			268 = {
				add_province_modifier = {
					name = giberd_options_war_bennon
					duration = 1825
				}
			}
		}
		add_treasury = -50
		random_owned_province = {
			limit = {
				infantry_in_province = 2
				infantry_in_province = ROOT
			}
			kill_units = {
				who = owner
				type = infantry
				amount = 2
			}
			rajput_infantry = ROOT
			rajput_infantry = ROOT
		}
		custom_tooltip = giberd_unable_to_research_10		# TODO: Implement
		custom_tooltip = giberd_ae_gnomish_minority_tt
		custom_tooltip = giberd_magisterium_oversight_tt
		custom_tooltip = has_already_happened_tt
		tooltip = {
			bennonhill_area = {
				add_permanent_claim = ROOT
			}
			hearthswood_area = {
				add_permanent_claim = ROOT
			}
		}
		set_estate_privilege = estate_artificers_organization_giberd_magisterium_oversight
	}
	option = {
		name = flavor_giberd.10.c
		add_prestige = 20
		add_country_modifier = {
			name = giberd_options_war_peace
			duration = 3650
		}
		# add_country_modifier = {
		# 	name = giberd_test_neg
		# 	duration = 3650
		# }
		# add_country_modifier = {
		# 	name = giberd_test_pos
		# 	duration = 3650
		# }
		research_speed = yes
		custom_tooltip = giberd_ae_gnomish_minority_tt		# TODO: Implement
		custom_tooltip = giberd_magisterium_oversight_tt
		custom_tooltip = has_already_happened_tt
		tooltip = {
			bennonhill_area = {
				add_permanent_claim = ROOT
			}
			hearthswood_area = {
				add_permanent_claim = ROOT
			}
		}
		set_estate_privilege = estate_artificers_organization_giberd_magisterium_oversight
	}
}

#Silver Linings are Laced in Gold
country_event = {
	id = flavor_giberd.11
	title = flavor_giberd.11.t
	desc = flavor_giberd.11.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.11.a
		add_favors = {
			who = A73
			amount = 20
		}
		if = {
			limit = {
				has_dlc = "The Cossacks"
			}
			add_country_modifier = {
				name = giberd_silverforge_favour_accepted
				duration = 3650
			}
		}
		else = {
			random_owned_province = {
				limit = {
					infantry_in_province = 2
					infantry_in_province = ROOT
				}
				kill_units = {
					who = owner
					type = infantry
					amount = 2
				}
				rajput_infantry = ROOT
				rajput_infantry = ROOT
			}
		}
	}
	option = {
		name = flavor_giberd.11.b
		add_country_modifier = {
			name = giberd_silverforge_favour_rejected
			duration = 5475
		}
	}
}

# Esmaraine challenges our Bid
country_event = {
	id = flavor_giberd.12
	title = flavor_giberd.12.t
	desc = flavor_giberd.12.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.12.a
		add_prestige = -20
		add_historical_rival = A44
	}
}

# finishing the gds loopeng gedsandde
country_event = {
	id = flavor_giberd.13
	title = flavor_giberd.13.t
	desc = flavor_giberd.13.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.13.a
		add_country_modifier = {
			name = giberd_gds_loopeng_gedsandde
			duration = -1
		}
		hidden_effect = {
			change_variable = {
				which = StaticArtificePoints
				value = 20
			}
		}
	}
}

# Convincing the emperor
country_event = {
	id = flavor_giberd.14
	title = flavor_giberd.14.t
	desc = flavor_giberd.14.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		# TODO: unlock tier 2 inventions
		name = flavor_giberd.14.a
		custom_tooltip = giberd_increases_our_artifice_upkeep_by_20
		custom_tooltip = artificer_points_upkeep_tt
		hidden_effect = {
			change_variable = {
				which = ArtificeUpkeep
				value = 20
			}
		}
		update_artifice_points = yes
		hidden_effect = {
			emperor = {
				country_event = {
					id = flavor_giberd.16
					days = 1
				}
			}
		}
	}
}

# The first Gnomish elector
country_event = {
	id = flavor_giberd.15
	title = flavor_giberd.15.t
	desc = flavor_giberd.15.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.15.a
		elector = ROOT
		country_event = {
			id = flavor_esmari.1
			days = 1
		}
		# TODO: unlock level 2 inventions
	}
}

# Giberd asks for an Electorate
country_event = {
	id = flavor_giberd.16
	title = flavor_giberd.16.t
	desc = flavor_giberd.16.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.16.a
		ai_chance = {
			factor = 100
		}
		A81 = {
			country_event = {
				id = flavor_giberd.15
				days = 30
			}
			hidden_effect = {
				country_event = {
					id = flavor_giberd.17
					days = 3650
				}
			}
		}
		if = {
			limit = {
				emperor = {
					ai = no
				}
			}
			country_event = {
				id = flavor_giberd.17
				days = 3650
			}
		}
	}
	option = {
		name = flavor_giberd.16.b
		ai_chance = {
			factor = 0
		}
		A81 = {
			hidden_effect = {
				subtract_variable = {
					which = ArtificeUpkeep
					value = 20
				}
			}
		}
	}
}

# The Mechanical Dragon
country_event = {
	id = flavor_giberd.17
	title = flavor_giberd.17.t
	desc = flavor_giberd.17.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.17.a
		if = {
			limit = {
				tag = A81
			}
			artifice_remove_20 = yes
		}
		emperor = {
			add_country_modifier = {
				name = giberd_mechanical_dragon
				duration = 3650
			}
		}
	}
}

# The Demands of the enclaves & Esmari
country_event = {
	id = flavor_giberd.18
	title = flavor_giberd.18.t
	desc = flavor_giberd.18.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.18.a
		every_owned_province = {
			limit = {
				region = esmaria_region
			}
			add_province_modifier = {
				name = giberd_demands_enclaves_promises_made
				duration = 1825
			}
		}
	}
}

# The shackles of the Magisterium
country_event = {
	id = flavor_giberd.19
	title = flavor_giberd.19.t
	desc = flavor_giberd.19.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.19.a
	}
	option = {
		name = flavor_giberd.19.b
	}
}

########
# electorate event chain
# Starting with Silverforge
country_event = {
	id = flavor_giberd.20
	title = flavor_giberd.20.t
	desc = flavor_giberd.20.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.20.a
		add_country_modifier = {
			name = giberd_silverforge_relations_good
			duration = 3650			#20 years
		}
		if = {
			limit = {
				exists = A25
			}
			country_event = {
				id = flavor_giberd.21				#damescrown
				days = 60
			}
		}
		if = {
			limit = {
				exists = A12
			}
			country_event = {
				id = flavor_giberd.22				#BEEPECK
				days = 120
			}
		}
		if = {
			limit = {
				exists = A11
			}
			country_event = {
				id = flavor_giberd.23				#pearsledge
				days = 180
			}
		}
		if = {
			limit = {
				exists = A31
			}
			country_event = {
				id = flavor_giberd.24				#Moonhaven
				days = 240
			}
		}
		if = {
			limit = {
				exists = A45
			}
			country_event = {
				id = flavor_giberd.25				#Istralore
				days = 300
			}
		}
		if = {
			limit = {
				exists = A85
			}
			country_event = {
				id = flavor_giberd.26				#Magisterium
				days = 360
			}
		}
	}
	option = {
		name = flavor_giberd.20.b
		if = {
			limit = {
				exists = A25
			}
			country_event = {
				id = flavor_giberd.21				#damescrown
				days = 60
			}
		}
		if = {
			limit = {
				exists = A12
			}
			country_event = {
				id = flavor_giberd.22				#BEEPECK
				days = 120
			}
		}
		if = {
			limit = {
				exists = A11
			}
			country_event = {
				id = flavor_giberd.23				#pearsledge
				days = 180
			}
		}
		if = {
			limit = {
				exists = A31
			}
			country_event = {
				id = flavor_giberd.24				#Moonhaven
				days = 240
			}
		}
		if = {
			limit = {
				exists = A45
			}
			country_event = {
				id = flavor_giberd.25				#Istralore
				days = 300
			}
		}
		if = {
			limit = {
				exists = A85
			}
			country_event = {
				id = flavor_giberd.26				#Magisterium
				days = 360
			}
		}
	}
}

# Down stream and up to Damescrown
country_event = {
	id = flavor_giberd.21
	title = flavor_giberd.21.t	##damescrown
	desc = flavor_giberd.21.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	trigger = {
		exists = A25
	}
	option = {
		name = flavor_giberd.21.a
		home_trade_node_effect_scope = {
			add_trade_modifier = {
				who = A25
				duration = 3650
				power = 100
				key = giberd_damescrown_contracts
			}
		}
		A25 = {
			add_opinion = {
				who = ROOT
				modifier = giberd_potions_bribe
				years = 10
			}
		}
	}
	option = {
		name = flavor_giberd.21.b
	}
}

country_event = {
	id = flavor_giberd.22	##beepeck
	title = flavor_giberd.22.t
	desc = flavor_giberd.22.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	trigger = {
		exists = A12
	}
	option = {
		name = flavor_giberd.22.a
		A12 = {
			add_prestige = 50
			add_country_modifier = {
				name = giberd_beepeck_honored_by_giberd
				duration = 3650
			}
		}
		add_country_modifier = {
			name = giberd_beepeck_pawns
			duration = 3650
		}
		add_prestige = -50
	}
	option = {
		name = flavor_giberd.22.b
	}
}

country_event = {
	id = flavor_giberd.23	##Pearsledge
	title = flavor_giberd.23.t
	desc = flavor_giberd.23.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	trigger = {
		exists = A11
	}
	option = {
		name = flavor_giberd.23.a
		add_treasury = -1000
		add_country_modifier = {
			name = giberd_we_bought_bad_wine
			duration = 7300
		}
		A11 = {
			add_country_modifier = {
				name = giberd_bought_bad_wine
				duration = 7300
			}
			add_opinion = {
				who = ROOT
				modifier = giberd_potions_bribe
			}
			add_treasury = 1000
		}
	}
	option = {
		name = flavor_giberd.23.b
	}
}

country_event = {
	id = flavor_giberd.24	##Moonhaven
	title = flavor_giberd.24.t
	desc = flavor_giberd.24.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	trigger = {
		exists = A31
	}
	option = {
		name = flavor_giberd.24.a
		A31 = {
			add_country_modifier = {
				name = artificers_good_moonhaven
				duration = 7300
			}
			add_opinion = {
				who = ROOT
				modifier = giberd_potions_bribe
			}
		}
		add_country_modifier = {
			name = artificers_aelantir
			duration = 7300
		}
	}
	option = {
		name = flavor_giberd.24.b
	}
}

country_event = {
	id = flavor_giberd.25	##Istralore
	title = flavor_giberd.25.t
	desc = flavor_giberd.25.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	trigger = {
		exists = A45
	}
	option = {
		name = flavor_giberd.25.a
		A45 = {
			add_country_modifier = {
				name = giberd_helped_istralroe
				duration = 7300
			}
			add_opinion = {
				who = ROOT
				modifier = giberd_potions_bribe
			}
		}
		add_country_modifier = {
			name = giberd_harmed_helping
			duration = 7300
		}
	}
	option = {
		name = flavor_giberd.25.b
	}
}

country_event = {
	id = flavor_giberd.26	##Masterium
	title = flavor_giberd.26.t
	desc = flavor_giberd.26.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	trigger = {
		exists = A45
	}
	option = {
		name = flavor_giberd.26.a
		A85 = {
			add_opinion = {
				who = ROOT
				modifier = giberd_potions_bribe
			}
		}
		add_country_modifier = {
			name = giberd_magisterial_oversight
			duration = 7300
		}
	}
	option = {
		name = flavor_giberd.26.b
	}
}

# What is in a name?
country_event = {
	id = flavor_giberd.29
	title = flavor_giberd.29.t
	desc = flavor_giberd.29.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.29.a
		add_country_modifier = {
			name = giberd_nation_esmaria_built
			duration = -1
		}
		change_tag = Z46
		# override_country_name = ESMARIA
	}
	option = {
		name = flavor_giberd.29.b
		add_country_modifier = {
			name = giberd_nation_esmaria_built
			duration = -1
		}
		override_country_name = IMPERIAL_HIERARCHY
	}
	option = {
		name = flavor_giberd.29.c
		add_country_modifier = {
			name = giberd_nation_esmaria_built
			duration = -1
		}
		override_country_name = CAIGHSODDA_HIERARCHY
	}
	option = {
		name = flavor_giberd.29.d
		add_country_modifier = {
			name = giberd_nation_esmaria_built
			duration = -1
		}
		override_country_name = GIBERDI_HIERARCHY
	}
}

########
# artificer faction events
# The Imperial Archive
country_event = {
	id = flavor_giberd.30
	title = flavor_giberd.30.t
	desc = flavor_giberd.30.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	after = {
		hidden_effect = {
			set_country_flag = giberd_faction_competition_enabled
			country_event = {
				id = flavor_giberd.40
				days = 3650
			}
		}
	}
	option = {
		name = flavor_giberd.30.a
		custom_tooltip = giberd_factions_explain_tt
		giberd_factions_technomancers_increase = yes
		add_treasury = -500
		every_elector = {
			add_opinion = {
				who = ROOT
				modifier = giberd_is_restoring_archive
				years = 10
			}
		}
		275 = {
			add_province_modifier = {
				name = giberd_restoring_archive
				duration = -1
			}
		}
		custom_tooltip = giberd_after_10_years_tt
		tooltip = {
			275 = {
				add_province_modifier = {
					name = giberd_restored_archive
					duration = -1
				}
			}
		}
	}
	option = {
		name = flavor_giberd.30.b
		custom_tooltip = giberd_factions_explain_tt
		giberd_factions_brillites_increase = yes
		add_treasury = -300
		add_adm_power = -75
		add_dip_power = -75
		add_mil_power = -75
		# TODO: -10 capacity for 10 years
		275 = {
			add_province_modifier = {
				name = giberd_scouring_archive
				duration = -1
			}
		}
		custom_tooltip = giberd_after_10_years_tt
		tooltip = {
			275 = {
				add_province_modifier = {
					name = giberd_scoured_archive
					duration = -1
				}
			}
		}
	}
	option = {
		name = flavor_giberd.30.c
		custom_tooltip = giberd_factions_explain_tt
		giberd_factions_mechanists_increase = yes
		add_treasury = -1000
		# TODO: -20 capacity for 10 years
		add_adm_power = -150
		add_dip_power = -150
		add_mil_power = -150
		every_elector = {
			add_opinion = {
				who = ROOT
				modifier = giberd_is_stealing_archive
				years = 10
			}
		}
		emperor = {
			add_opinion = {
				who = ROOT
				modifier = giberd_is_stealing_archive
				years = 10
			}
		}
		271 = {
			add_province_modifier = {
				name = giberd_stealing_archive
				duration = -1
			}
		}
		custom_tooltip = giberd_after_10_years_tt
		tooltip = {
			271 = {
				add_province_modifier = {
					name = giberd_stolen_archive
					duration = -1
				}
			}
		}
	}
}

# Addressing the Damestear demand
country_event = {
	id = flavor_giberd.31
	title = flavor_giberd.31.t
	desc = flavor_giberd.31.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		# technomancers
		name = flavor_giberd.31.a
		goto = 265
		giberd_factions_technomancers_increase = yes
		265 = {
			change_trade_goods = damestear
			set_province_flag = permanent_damestear
			add_province_modifier = {
				name = giberd_damestear_port_high
				duration = -1
			}
		}
		add_treasury = -2000
		add_country_modifier = {
			name = giberd_paying_the_moonisle
			duration = -1
		}
		custom_tooltip = flavor_giberd.32.war_tt		# TODO: implement
	}
	option = {
		# brillites
		name = flavor_giberd.31.b
		goto = 265
		giberd_factions_brillites_increase = yes
		country_event = {
			id = flavor_giberd.32
			days = 1
		}
		tooltip = {
			add_treasury = -500
		}
	}
	option = {
		# mechanists
		name = flavor_giberd.31.c
		goto = 9
		giberd_factions_mechanists_increase = yes
		9 = {
			add_permanent_claim = ROOT
		}
	}
}

# Short term low amount renewable deal for Damestear
country_event = {
	id = flavor_giberd.32
	title = flavor_giberd.32.t
	desc = flavor_giberd.32.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		# yes
		name = flavor_giberd.32.a
		custom_tooltip = flavor_giberd.32.accept_tt
		add_treasury = -500
		if = {
			limit = {
				265 = {
					NOT = {
						has_province_modifier = giberd_damestear_port_low
					}
				}
			}
			hidden_effect = {
				265 = {
					add_province_modifier = {
						name = giberd_damestear_port_low
						duration = -1
					}
				}
			}
			hidden_effect = {
				change_variable = {
					which = StaticArtificePoints
					value = 3
				}
			}
			update_artifice_points = yes
		}
	}
	option = {
		# no
		name = flavor_giberd.32.b
		custom_tooltip = flavor_giberd.32.reject_tt
		if = {
			limit = {
				265 = {
					has_province_modifier = giberd_damestear_port_low
				}
			}
			remove_province_modifier = giberd_damestear_port_low
			hidden_effect = {
				subtract_variable = {
					which = StaticArtificePoints
					value = 3
				}
				update_artifice_points = yes
			}
		}
	}
	after = {
		country_event = {
			id = flavor_giberd.32
			days = 3650
		}
	}
}

# Esmaria's last port of call
country_event = {
	id = flavor_giberd.33
	title = flavor_giberd.33.t
	desc = flavor_giberd.33.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.33.a
		giberd_factions_technomancers_increase = yes
		add_country_modifier = {
			name = giberd_estallen_share
			duration = -1
		}
		home_trade_node_effect_scope = {
			add_trade_modifier = {
				who = ROOT
				duration = -1
				power = 100
				key = giberd_estallen_trade_deal
			}
			add_trade_modifier = {
				who = A93
				duration = -1
				power = -100
				key = giberd_estallen_trade_deal
			}
			every_trade_node_member_province = {
				limit = {
					owned_by = A93
				}
				add_province_modifier = {
					name = giberd_business_ventures
					duration = -1
				}
			}
		}
		custom_tooltip = flavor_giberd.33.war_tt		# TODO: implement
	}
	option = {
		name = flavor_giberd.33.b
		giberd_factions_brillites_increase = yes
		add_manpower = -20
		280 = {
			add_permanent_province_modifier = {
				name = giberd_lock_out_estallen
				duration = -1
			}
			owner = {
				add_country_modifier = {
					name = giberd_estallen_embargo
					duration = 9125
				}
			}
		}
	}
	option = {
		name = flavor_giberd.33.c
		giberd_factions_mechanists_increase = yes
		280 = {
			add_permanent_claim = ROOT
		}
		576 = {
			add_permanent_claim = ROOT
		}
	}
}

# Silverforge's due
country_event = {
	id = flavor_giberd.34
	title = flavor_giberd.34.t
	desc = flavor_giberd.34.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.34.a
		giberd_factions_technomancers_increase = yes
		custom_tooltip = giberd_construction_of_silverforge_large_tt
		custom_tooltip = artificer_points_upkeep_tt
		set_country_flag = giberd_silverforge_hold_large
		hidden_effect = {
			change_variable = {
				which = ArtificeUpkeep
				value = 30
			}
		}
		update_artifice_points = yes
		add_country_modifier = {
			name = giberd_paying_for_silverforge
			duration = 3650
		}
		912 = {
			add_province_modifier = {
				name = giberd_silverforge_hold
				duration = -1
			}
		}
		custom_tooltip = giberd_silverforge_war_tt		# TODO: implement
		large_increase_of_dwarven_tolerance_effect = yes
		for = {
			custom_tooltip = giberd_10_provinces_get_dwarves_tt
			amount = 10
			effect = "random_province = { limit = { region = esmaria_region } add_dwarven_minority_size_effect = yes }"
		}
	}
	option = {
		name = flavor_giberd.34.b
		giberd_factions_brillites_increase = yes
		custom_tooltip = giberd_10_capacity_10_years_tt
		set_country_flag = giberd_silverforge_hold_small
		custom_tooltip = artificer_points_upkeep_tt
		hidden_effect = {
			change_variable = {
				which = ArtificeUpkeep
				value = 10
			}
		}
		update_artifice_points = yes
		for = {
			custom_tooltip = giberd_2_provinces_get_dwarves_tt
			amount = 2
			effect = "random_province = { limit = { region = esmaria_region } add_dwarven_minority_size_effect = yes }"
		}
	}
	option = {
		name = flavor_giberd.35.a
		giberd_factions_mechanists_increase = yes
		remove_historical_friend = A73
		A73 = {
			add_casus_belli = {
				type = cb_insult
				target = ROOT
				months = 120
			}
		}
		308 = {
			add_permanent_claim = ROOT
		}
		912 = {
			add_permanent_claim = ROOT
		}
	}
	after = {
		hidden_effect = {
			country_event = {
				id = flavor_giberd.35
				days = 3650
			}
		}
	}
}

# cleanup after .34
country_event = {
	id = flavor_giberd.35
	title = flavor_giberd.35.t
	desc = flavor_giberd.35.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	hidden = yes
	option = {
		name = flavor_giberd.34.a
		if = {
			limit = {
				has_country_flag = giberd_silverforge_hold_large
			}
			clr_country_flag = giberd_silverforge_hold_large
			subtract_variable = {
				which = ArtificeUpkeep
				value = 30
			}
		}
		if = {
			limit = {
				has_country_flag = giberd_silverforge_hold_small
			}
			clr_country_flag = giberd_silverforge_hold_small
			subtract_variable = {
				which = ArtificeUpkeep
				value = 10
			}
		}
	}
}

# Damescrown's due
country_event = {
	id = flavor_giberd.36
	title = flavor_giberd.36.t
	desc = flavor_giberd.36.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	immediate = {
		234 = {
			owner = {
				save_event_target_as = damescrown_owner
			}
		}
	}
	option = {
		name = flavor_giberd.36.a
		giberd_factions_technomancers_increase = yes
		custom_tooltip = giberd_10_capacity_10_years_tt
		custom_tooltip = artificer_points_upkeep_tt
		set_country_flag = giberd_damescrown_due_large
		hidden_effect = {
			change_variable = {
				which = ArtificeUpkeep
				value = 10
			}
		}
		update_artifice_points = yes
		234 = {
			add_province_modifier = {
				name = giberd_damescrown_wind_tower
				duration = -1
			}
			owner = {
				add_opinion = {
					who = ROOT
					modifier = giberd_wind_tower_opinion_up
					years = 20
				}
			}
		}
	}
	option = {
		name = flavor_giberd.36.b
		giberd_factions_brillites_increase = yes
		custom_tooltip = giberd_5_capacity_5_years_tt
		custom_tooltip = artificer_points_upkeep_tt
		set_country_flag = giberd_damescrown_due_small
		hidden_effect = {
			change_variable = {
				which = ArtificeUpkeep
				value = 5
			}
		}
		update_artifice_points = yes
		234 = {
			owner = {
				add_opinion = {
					who = ROOT
					modifier = giberd_wind_tower_opinion_down
					years = 20
				}
			}
		}
		home_trade_node_effect_scope = {
			add_trade_modifier = {
				who = event_target:damescrown_owner
				duration = -1
				power = -30
				key = giberd_damescrown_diverted_trade
			}
		}
	}
	option = {
		name = flavor_giberd.36.c
		giberd_factions_mechanists_increase = yes
		262 = {
			add_permanent_claim = ROOT
		}
		908 = {
			add_permanent_claim = ROOT
		}
		234 = {
			add_permanent_claim = ROOT
		}
		declare_war_with_cb = {
			who = event_target:damescrown_owner
			casus_belli = cb_conquest
			war_goal_province = 234
		}
		if = {
			limit = {
				any_known_country = {
					is_in_trade_league_with = event_target:damescrown_owner
				}
			}
			every_known_country = {
				limit = {
					OR = {
						tag = event_target:damescrown_owner
						is_in_trade_league_with = event_target:damescrown_owner
					}
				}
				add_opinion = {
					who = ROOT
					modifier = giberd_wind_tower_opinion_down
					multiplier = 2
					years = 20
				}
			}
		}
	}
	after = {
		hidden_effect = {
			country_event = {
				id = flavor_giberd.37
				days = 3650
			}
		}
	}
}

# cleanup after .36
country_event = {
	id = flavor_giberd.37
	title = flavor_giberd.37.t
	desc = flavor_giberd.37.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	hidden = yes
	option = {
		name = flavor_giberd.37.a
		if = {
			limit = {
				has_country_flag = giberd_damescrown_due_large
			}
			clr_country_flag = giberd_damescrown_due_large
			subtract_variable = {
				which = ArtificeUpkeep
				value = 10
			}
		}
		if = {
			limit = {
				has_country_flag = giberd_damescrown_due_small
			}
			clr_country_flag = giberd_damescrown_due_small
			subtract_variable = {
				which = ArtificeUpkeep
				value = 5
			}
		}
	}
}

# Arcane Arts and Artificery
country_event = {
	id = flavor_giberd.38
	title = flavor_giberd.38.t
	desc = flavor_giberd.38.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.38.a
		giberd_factions_technomancers_increase = yes
		add_estate_loyalty_modifier = {
			estate = estate_artificers
			desc = giberd_the_guilds_betrayed_tt
			loyalty = -20
			duration = 7300
		}
		add_estate_influence_modifier = {
			estate = estate_artificers
			desc = giberd_the_guilds_betrayed_influence_tt
			influence = -20
			duration = 7300
		}
		# TODO: unable to research for 20 years
		add_estate_influence_modifier = {
			estate = estate_mages
			desc = giberd_abundance_of_mages_tt
			influence = 20
			duration = 7300
		}
		custom_tooltip = linebreak_tt
		custom_tooltip = has_already_happened_tt
		custom_tooltip = giberd_magisterium_oversight_buffed_tt		# TODO: implement
	}
	option = {
		name = flavor_giberd.38.b
		giberd_factions_brillites_increase = yes
		add_country_modifier = {
			name = giberd_fed_misinformation
			duration = 7300
		}
		add_estate_influence_modifier = {
			estate = estate_mages
			desc = giberd_fed_misinformation_influence_tt
			influence = -10
			duration = 3650
		}
		add_country_modifier = {
			name = giberd_magisterium_merchants
			duration = 7300
		}
		custom_tooltip = linebreak_tt
		custom_tooltip = has_already_happened_tt
		custom_tooltip = giberd_magisterium_oversight_buffed_tt
	}
	option = {
		name = flavor_giberd.38.c
		giberd_factions_mechanists_increase = yes
		add_country_modifier = {
			name = giberd_sticking_it_to_the_mages
			duration = 7300
		}
		if = {
			limit = {
				exists = A85
			}
			add_casus_belli = {
				type = cb_insult
				target = A85
				months = 60
			}
			declare_war_with_cb = {
				who = A85
				casus_belli = cb_insult
			}
		}
		add_estate_loyalty_modifier = {
			estate = estate_mages
			desc = giberd_sticking_it_to_the_mages_tt
			loyalty = -30
			duration = 7300
		}
		add_estate_loyalty_modifier = {
			estate = estate_artificers
			desc = giberd_sticking_it_to_the_mages_tt
			loyalty = 20
			duration = 7300
		}
		add_estate_influence_modifier = {
			estate = estate_artificers
			desc = giberd_sticking_it_to_the_mages_influence_tt
			influence = 20
			duration = 7300
		}
		custom_tooltip = linebreak_tt
		custom_tooltip = has_already_happened_tt
		custom_tooltip = giberd_magisterium_oversight_buffed_tt
	}
}

# What to do about the Ravelians
country_event = {
	id = flavor_giberd.39
	title = flavor_giberd.39.t
	desc = flavor_giberd.39.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	immediate = {
		set_country_flag = giberd_ravelians_role
	}
	option = {
		name = flavor_giberd.39.a
		giberd_factions_technomancers_increase = yes
		custom_tooltip = flavor_giberd.39_tt
		giberd_leader_technomancers_bonus = yes
	}
	option = {
		name = flavor_giberd.39.b
		giberd_factions_brillites_increase = yes
		custom_tooltip = flavor_giberd.39_tt
		giberd_leader_brillites_bonus = yes
		# add_estate_loyalty_modifier = {
		# 	estate = estate_artificers
		# 	desc = giberd_leader_brillites_loyalty_tt
		# 	loyalty = -10
		# 	duration = -1
		# }
	}
	option = {
		name = flavor_giberd.39.c
		giberd_factions_mechanists_increase = yes
		custom_tooltip = flavor_giberd.39_tt
		giberd_leader_mechanists_bonus = yes
		# add_estate_loyalty_modifier = {
		# 	estate = estate_artificers
		# 	desc = giberd_leader_mechanists_loyalty_tt
		# 	loyalty = 10
		# 	duration = -1
		# }
	}
}

# cleanup for .30
country_event = {
	id = flavor_giberd.40
	title = flavor_giberd.40.t
	desc = flavor_giberd.40.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	hidden = yes
	option = {
		name = flavor_giberd.40.a
		if = {
			limit = {
				275 = {
					has_province_modifier = giberd_restoring_archive
				}
			}
			275 = {
				remove_province_modifier = giberd_restoring_archive
				add_province_modifier = {
					name = giberd_restored_archive
					duration = -1
				}
			}
		}
		if = {
			limit = {
				275 = {
					has_province_modifier = giberd_scouring_archive
				}
			}
			275 = {
				remove_province_modifier = giberd_scouring_archive
				add_province_modifier = {
					name = giberd_scoured_archive
					duration = -1
				}
			}
		}
		if = {
			limit = {
				271 = {
					has_province_modifier = giberd_stealing_archive
				}
			}
			271 = {
				remove_province_modifier = giberd_stealing_archive
				add_province_modifier = {
					name = giberd_stolen_archive
					duration = -1
				}
			}
		}
	}
}

# Artificer Faire
country_event = {
	id = flavor_giberd.41
	title = flavor_giberd.41.t
	desc = flavor_giberd.41.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.41.a
		custom_tooltip = flavor_giberd.41_tt
		hidden_effect = {
			if = {
				limit = {
					AND = {
						check_variable = {
							which = giberd_factions_technomancers_influence
							which = giberd_factions_brillites_influence
						}
						check_variable = {
							which = giberd_factions_technomancers_influence
							which = giberd_factions_mechanists_influence
						}
					}
				}
				country_event = {
					id = flavor_giberd.42					# technomancers
					days = 180
				}
			}
			else_if = {
				limit = {
					check_variable = {
						which = giberd_factions_brillites_influence
						which = giberd_factions_mechanists_influence
					}
				}
				country_event = {
					id = flavor_giberd.43					# brillites
					days = 180
				}
			}
			else = {
				country_event = {
					id = flavor_giberd.44					# mechanists
					days = 180
				}
			}
		}
	}
}

# Technomancers win: Giberd: A Nation Favoured
country_event = {
	id = flavor_giberd.42
	title = flavor_giberd.42.t
	desc = flavor_giberd.42.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.42.a
		add_estate_loyalty_modifier = {
			estate = estate_artificers
			desc = giberd_nation_favoured_tt
			loyalty = 10
			duration = -1
		}
		add_country_modifier = {
			name = giberd_deluge_of_investment
			duration = -1
		}
	}
}

# Brillites win: Giberd: A Nation Financed
country_event = {
	id = flavor_giberd.43
	title = flavor_giberd.43.t
	desc = flavor_giberd.43.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.43.a
		add_country_modifier = {
			name = giberd_language_of_esmar
			duration = -1
		}
	}
}

# Mechanists win: Giberd: A Nation Friendless
country_event = {
	id = flavor_giberd.44
	title = flavor_giberd.44.t
	desc = flavor_giberd.44.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	option = {
		name = flavor_giberd.44.a
		add_country_modifier = {
			name = giberd_show_our_might
			duration = -1
		}
	}
}
