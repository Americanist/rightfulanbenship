namespace = flavor_kobildzan

country_event = { #The Meaning of Dragonfire
	id = flavor_kobildzan.1
	title = flavor_kobildzan.1.t
	desc = flavor_kobildzan.1.d
	picture = GREAT_BUILDING_eventPicture #LEX CHANGE THIS
	is_triggered_only = yes

	option = { #Power!
		name = flavor_kobildzan.1.a
		custom_tooltip = dragons_mean_power_tt #LEX TO-DO
		hidden_effect = { set_country_flag = dragons_mean_power }
		add_country_modifier = {
			name = Z38_dragons_mean_power
			duration = 3650
		}
	}
	option = { #Change!
		name = flavor_kobildzan.1.b
		custom_tooltip = dragons_mean_change_tt #LEX TO-DO
		hidden_effect = { set_country_flag = dragons_mean_change }
		add_country_modifier = {
			name = Z38_dragons_mean_change
			duration = 3650
		}
	}
}

country_event = { #To Become Dragons
	id = flavor_kobildzan.2
	title = flavor_kobildzan.2.t
	desc = flavor_kobildzan.2.d
	picture = GREAT_BUILDING_eventPicture #LEX CHANGE THIS
	is_triggered_only = yes

	option = { #WE ARE KOBILDZAN! OF DRAGONS AND KOBOLDS!
		name = flavor_kobildzan.2.a
		change_government = republic
		add_government_reform = technocracy_republic_reform
		if = {
			limit = { is_tribal = no }
			if = {
				limit = { reform_level = 5 }
				change_government_reform_progress = 50
			}
			else_if = {
				limit = { reform_level = 4 }
				change_government_reform_progress = 40				
			}
			else_if = {
				limit = { reform_level = 3 }
				change_government_reform_progress = 30				
			}
			else_if = {
				limit = { reform_level = 2 }
				change_government_reform_progress = 20				
			}
		}
		custom_tooltip = gain_reform_progress_per_reform_level_tt #LEX TO-DO
		if = {
			limit = { NOT = { tag = Z38 } }
			189 = {
				move_capital_effect = yes
				add_base_tax = 4
				add_base_production = 4
				add_base_manpower = 4
			}
			change_tag = Z38
			hidden_effect = { restore_country_name = yes }
			swap_non_generic_missions = yes
			custom_tooltip = tooltip_kobildzani_culture_provinces
			hidden_effect = {
				every_owned_province = {
					limit = {
						culture_group = kobold
					}
					change_culture = kobildzani_kobold
				}
			}
			primary_and_ruler_culture_change = { race = kobold new_culture = kobildzani_kobold }
			remove_non_electors_emperors_from_empire_effect = yes
			if = {
				limit = {
					NOT = { government_rank = 3 }
				}
				set_government_rank = 3
			}
			dragon_coast_region = {
				limit = {
					NOT = { owned_by = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_permanent_claim = Z38
			}
			add_prestige = 25
			if = {
				limit = { has_custom_ideas = no }
				country_event = { id = ideagroups.1 } #Swap Ideas
			}
			add_country_modifier = {
				name = "centralization_modifier"
				duration = 7300
			}
			set_global_flag = formed_kobildzan_flag
			lock_racial_admin = yes
		}
	}
}

country_event = { #In the Flesh
	id = flavor_kobildzan.3
	title = flavor_kobildzan.3.t
	desc = flavor_kobildzan.3.d
	picture = GREAT_BUILDING_eventPicture #LEX CHANGE THIS
	is_triggered_only = yes #LEX TO-DO ON PULSE 

	option = { #WE'RE GONNA MEET A DRAGON!!!
		name = flavor_kobildzan.3.a
		rzenta_region = {
			discover_country = ROOT
		}
		1191 = {
			owner = {
				add_opinion = { 
					who = ROOT
					modifier = tribute_to_a_dragon
				}
				reverse_add_opinion = {
					who = ROOT
					modifier = tribute_to_a_dragon
				}
				ROOT = {
					capital_scope = {
						discover_country = prev
					}
				}
			}
		}
	}
}

country_event = { #Meeting Varlengeilt
	id = flavor_kobildzan.4
	title = flavor_kobildzan.4.t
	desc = flavor_kobildzan.4.d
	picture = GREAT_BUILDING_eventPicture #LEX CHANGE THIS
	is_triggered_only = yes 

	option = { #A DRAGON LIKES US!!!
		name = flavor_kobildzan.4.a
		rzenta_region = {
			limit = { NOT = { is_empty = yes } }
			add_claim = ROOT
		}
		every_subject_country = {
			limit = {
				capital_scope = { superregion = ynn_superregion } 
				NOT = { capital_scope = { colonial_region = colonial_broken_sea }  }
			}
			change_religion = drozma_tur
			hidden_effect = {
				every_owned_province = {
					limit = { religion = kobold_dragon_cult }
					change_religion = drozma_tur
				}
			}
		}
		largest_increase_of_ruinborn_tolerance_effect = yes 
	}
}

country_event = { #To Find Tayekan
	id = flavor_kobildzan.5
	title = flavor_kobildzan.5.t
	desc = flavor_kobildzan.5.d
	picture = GREAT_BUILDING_eventPicture #LEX CHANGE THIS
	is_triggered_only = yes 

	option = { #A conflict of faith and kind.
		name = flavor_kobildzan.5.a
		if = {
			limit = {
				OR = {
					exists = H31
					exists = H30
					exists = H32
					exists = U31
				}
			}
			custom_tooltip = to_find_tayekan_1_tt #LEX TO-DO
			random_owned_province = {
				limit = { culture_group = kobold }
				remove_random_development = yes
			}
			if = {
				limit = { exists = H31 }
				H31 = {
					random_owned_province = {
						add_random_development = 2
					}
				}
			}
			else_if = {
				limit = { exists = H30 }
				H30 = {
					random_owned_province = {
						add_random_development = 2
					}
				}				
			}
			else_if = {
				limit = { exists = H32 }
				H32 = {
					random_owned_province = {
						add_random_development = 2
					}
				}				
			}	
			else = {
				U31 = {
					random_owned_province = {
						add_random_development = 2
					}					
				}
			}
			hidden_effect = {
				country_event = { id = flavor_kobildzan.6 days = 1825 }
				country_event = { id = flavor_kobildzan.6 days = 3650 }
				country_event = { id = flavor_kobildzan.6 days = 5475 }
			}		
		}
		else = {
			custom_tooltip = to_find_tayekan_2_tt #LEX TO-DO
			hidden_effect = { set_country_flag = kobildzan_artificer_spawn }
		}
	}
}

country_event = { #Artificer Malcontents
	id = flavor_kobildzan.6
	title = flavor_kobildzan.6.t
	desc = flavor_kobildzan.6.d #LEX CHANGE THIS
	picture = GREAT_BUILDING_eventPicture #LEX CHANGE THIS
	is_triggered_only = yes 

	trigger = {
		OR = {
			exists = H31
			exists = H30
			exists = H32
			exists = U31
		}
	}

	option = { #We must conquer Haraf!
		name = flavor_kobildzan.6.a
		custom_tooltip = to_find_tayekan_1_tt #LEX TO-DO
		random_owned_province = {
			limit = { culture_group = kobold }
			remove_random_development = yes
		}
		if = {
			limit = { exists = H31 }
			H31 = {
				random_owned_province = {
					add_random_development = 2
				}
			}
		}
		else_if = {
			limit = { exists = H30 }
			H30 = {
				random_owned_province = {
					add_random_development = 2
				}
			}				
		}
		else_if = {
			limit = { exists = H32 }
			H32 = {
				random_owned_province = {
					add_random_development = 2
				}
			}				
		}	
		else = {
			U31 = {
				random_owned_province = {
					add_random_development = 2
				}					
			}
		}		
	}
}

country_event = { #A Meeting of Technopriests
	id = flavor_kobildzan.7
	title = flavor_kobildzan.7.t
	desc = flavor_kobildzan.7.d
	picture = GREAT_BUILDING_eventPicture #LEX CHANGE THIS
	is_triggered_only = yes 

	option = { #Brillites!
		name = flavor_kobildzan.7.a
		add_country_modifier = {
			name = Z38_perma_brilliance
			duration = -1
		}
	}
	option = { #Technomancers!
		name = flavor_kobildzan.7.b
		add_country_modifier = {
			name = Z38_perma_technomancy
			duration = -1
		}
	}
	option = { #Mechanists!
		name = flavor_kobildzan.7.c
		add_country_modifier = {
			name = Z38_perma_mechanists
			duration = -1
		}
	}
}

country_event = { #Twin Empires
	id = flavor_kobildzan.8
	title = flavor_kobildzan.8.t
	desc = flavor_kobildzan.8.d
	picture = GREAT_BUILDING_eventPicture #LEX CHANGE THIS
	is_triggered_only = yes 

	option = { #Two empires, forged as kin!
		name = flavor_kobildzan.8.a
		hidden_effect = {	
			1191 = {
				cede_province = ROOT
			}
			every_owned_province = {
				limit = {
					superregion = ynn_superregion
					NOT = { colonial_region = colonial_broken_sea }
				}
				add_core = H24
			}
		}
		release = H24
		create_subject = {
			subject_type = twin_empire
			subject = H24
		}
		hidden_effect = {
			every_subject_country = {
				every_owned_province = {
					limit = {
						superregion = ynn_superregion
						NOT = { colonial_region = colonial_broken_sea }
					}
					add_core = H24
					cede_province = H24
				}
			}
			set_country_flag = kobildzan_dragon_dominion_friends
		}
		hidden_effect = {
			add_historical_friend = H24
			H24 = { add_historical_friend = ROOT }
		}
		dolindha_region = {
			add_permanent_claim = H24
		}
		if = {
			limit = { has_church_aspect = green_dragon_1_base }
			remove_church_aspect = green_dragon_1_base
		}
		unlock_kobold_dragon_cult_for_colour_slot_upgrade = {
			COLOUR = green
			SLOT = 1
			UPGRADE = base
		}
	}
}

country_event = { #Artificery As One
	id = flavor_kobildzan.9
	title = flavor_kobildzan.9.t
	desc = flavor_kobildzan.9.d
	picture = GREAT_BUILDING_eventPicture #LEX CHANGE THIS
	is_triggered_only = yes 

	option = { #To Tayekan!
		name = flavor_kobildzan.9.a
		large_increase_of_goblin_tolerance_effect = yes
		large_increase_of_gnomish_tolerance_effect = yes
		custom_tooltip = gnomes_from_across_cannor_tt #LEX DO THIS
		custom_tooltip = goblins_from_across_cannor_tt #LEX DO THIS
		hidden_effect = {
			for = {
				amount = 8
				effect = "
					random_owned_province = {
						limit = {
							region = dragon_coast_region
							NOT = { culture_group = gnomish } 
							NOT = { has_large_gnomish_minority_trigger }
						}
						add_gnomish_minority_size_effect = yes 
					}
				"
			}
			for = {
				amount = 4
				effect = "
					random_owned_province = {
						limit = {
							region = dragon_coast_region
							NOT = { culture_group = goblin } 
						}
						add_goblin_minority_size_effect = yes 
					}
				"
			}
		}
		if = { limit = { has_church_aspect = blue_dragon_2_base }
			remove_church_aspect = blue_dragon_2_base
		}
		unlock_kobold_dragon_cult_for_colour_slot_upgrade = {
			COLOUR = blue
			SLOT = 2
			UPGRADE = upgraded
		}
	}
}

country_event = { #The Greatest Hoard on Halann
	id = flavor_kobildzan.10
	title = flavor_kobildzan.10.t
	desc = flavor_kobildzan.10.d
	picture = GREAT_BUILDING_eventPicture #LEX CHANGE THIS
	is_triggered_only = yes 

	option = { #And then, the world shook again...
		name = flavor_kobildzan.10.a
		country_event = { id = flavor_kobildzan.11 days = 1 }
	}
}

country_event = { #The Dragon's Roar
	id = flavor_kobildzan.11
	title = flavor_kobildzan.11.t
	desc = flavor_kobildzan.11.d
	picture = GREAT_BUILDING_eventPicture #LEX CHANGE THIS
	is_triggered_only = yes 

	option = { #Oh no.
		name = flavor_kobildzan.11.a
		custom_tooltip = dragons_roar_tt #LEX DO THIS
		hidden_effect = {
			189 = {
				add_base_tax = -3
				add_base_production = -3
				add_base_manpower = -3
				add_devastation = 50 #yes this stacks with the dragondepth one on purpose
			}
			dragon_coast_region = {
				limit = {
					NOT = {
						OR = {
							area = dragondepth_area
							area = dragonheart_area
							area = dragonmaw_area
						}
					}
				}
				remove_random_development = yes
				add_devastation = 75
			}
			dragondepth_area = { add_devastation = 50 }
			dragonheart_area = { add_devastation = 50 }
			dragonmaw_area = { add_devastation = 50 }
			# Small Country + upper half of West Dameshead + western half of Alenic Reach lose 1 dev, gain 75 dev
			# Rest of Dameshead + Dalr + Esmaria + Lenceor gain 50 devastation
			alenic_frontier_region = {
				remove_random_development = yes
				add_devastation = 75				
			}
			small_country_region = {
				remove_random_development = yes
				add_devastation = 75					
			}
			damescrown_region = {
				remove_random_development = yes
				add_devastation = 75				
			}
			alenic_frontier_region = {
				limit = {
					NOT = {
						OR = {
							area = cestir_area
							area = jonsway_area
							area = balvord_area
						}
					}
				}
				remove_random_development = yes
				add_devastation = 75
			}
			cestir_area = { add_devastation = 50 }
			jonsway_area = { add_devastation = 50 }
			balvord_area = { add_devastation = 50 }
			serpentshead_area = { add_devastation = 50 }
			balvord_area = { add_devastation = 50 }
			northern_greatwoods_area = { add_devastation = 50 }
			dinesck_area = { add_devastation = 50 }
			west_chillsbay_area = { add_devastation = 50 }
			west_dameshead_region = {
				limit = { NOT = { area = exwes_area } }
				add_devastation = 50
			}
			exwes_area = {
				remove_random_development = yes
				add_devastation = 75
			}
			west_damesear_area = { add_devastation = 50 }
			east_damesear_area = { add_devastation = 50 }
			the_commons_area = { add_devastation = 50 }
			damerian_dales_area = { add_devastation = 50 }
			silverwoods_area = { add_devastation = 50 }
			eastneck_area = { add_devastation = 50 }
			cann_esmar_area = { add_devastation = 50 }
			ryalanar_area = { add_devastation = 50 }
			konwell_area = { add_devastation = 50 }
			lencenor_region = {
				limit = {
					NOT = {
						OR = {
							area = deranne_area
							area = southroy_area
							area = redglades_area
						}
					}
				}
				add_devastation = 50
			}
			deranne_area = { add_devastation = 50 }
			southroy_area = { add_devastation = 50 }
			redglades_area = { add_devastation = 50 }
			revrland_area = { add_devastation = 50 }
			frostbridges_area = { add_devastation = 50 }
			varheim_area = { add_devastation = 50 }
			bjarnland_area = { add_devastation = 50 }
			deranne_area = { add_devastation = 50 }
		}
	}
}
