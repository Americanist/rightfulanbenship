namespace = genie_cult

# Genie cult power gain
country_event = {
	id = genie_cult.1
	title = genie_cult.1.t
	desc = genie_cult.1.d
	picture = RELIGIOUS_CONVERSION_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	trigger = {
		religion = genie_cult
	}
	
	option = {
		name = genie_cult.1.a
		
		clr_country_flag = genie_cult_power_gain_flag
		if = {
			limit = {
				NOT = {
					check_variable = {
						which = genie_cult_power_counter
						value = 10
					}
				}
			}
			change_variable = {
				which = genie_cult_power_counter
				value = 1
			}
		}
		country_event = {
			id = genie_cult.2
			days = 1094
		}
	}
}

country_event = {
	id = genie_cult.2
	title = genie_cult.2.t
	desc = genie_cult.2.d
	picture = RELIGIOUS_CONVERSION_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	trigger = {
		religion = genie_cult
	}

	option = {
		name = genie_cult.2.a
		
		set_country_flag = genie_cult_power_gain_flag
		capital_scope = {
			add_province_triggered_modifier = genie_cult_power_gain
		}
	}
}

#Genie Cult Power Menu
country_event = {
	id = genie_cult.3
	title = genie_cult.3.t
	desc = genie_cult.3.d
	picture = RELIGIOUS_CONVERSION_eventPicture
	
	is_triggered_only = yes

	option = {
		name = genie_cult.3.a
		country_event = {
			id = genie_cult.4
		}
	}

	option = {
		name = genie_cult.3.b
		trigger = {
			custom_trigger_tooltip = {
				tooltip = genie_cult_has_at_least_2_power_tt
				check_variable = {
					which = genie_cult_power_counter
					value = 2
				}
			}
		}
		country_event = {
			id = genie_cult.5
		}
	}

	option = {
		name = genie_cult.3.c
		trigger = {
			custom_trigger_tooltip = {
				tooltip = genie_cult_has_at_least_3_power_tt
				check_variable = {
					which = genie_cult_power_counter
					value = 3
				}
			}
		}
		country_event = {
			id = genie_cult.6
		}
	}

	option = {
		name = genie_cult.3.dd
		trigger = {
			custom_trigger_tooltip = {
				tooltip = genie_cult_has_at_least_4_power_tt
				check_variable = {
					which = genie_cult_power_counter
					value = 4
				}
			}
		}
		country_event = {
			id = genie_cult.7
		}
	}

	option = {
		name = genie_cult.3.e
		clr_country_flag = genie_cult_power_menu_open
	}
}

#Power Incantations (Cost 1)
country_event = {
	id = genie_cult.4
	title = genie_cult.4.t
	desc = genie_cult.4.d
	picture = RELIGIOUS_CONVERSION_eventPicture
	
	is_triggered_only = yes

	option = {
		name = genie_cult.4.a
		add_country_modifier = {
			name = warmth_of_life
			duration = 1825
		}
	}

	option = {
		name = genie_cult.4.b
		add_country_modifier = {
			name = guiding_sands
			duration = 1825
		}
	}

	option = {
		name = genie_cult.4.c
		country_event = {
			id = genie_cult.3
		}
	}
}

#Charge Incantations (Cost 2)
country_event = {
	id = genie_cult.5
	title = genie_cult.5.t
	desc = genie_cult.5.d
	picture = RELIGIOUS_CONVERSION_eventPicture
	
	is_triggered_only = yes

	option = {
		name = genie_cult.5.a
		add_country_modifier = {
			name = lightrocks
			duration = 1825
		}
	}

	option = {
		name = genie_cult.5.b
		add_country_modifier = {
			name = armor_off
			duration = 1825
		}
	}

	option = {
		name = genie_cult.5.c
		add_country_modifier = {
			name = battle_fervor
			duration = 1825
		}
	}

	option = {
		name = genie_cult.5.dd
		country_event = {
			id = genie_cult.3
		}
	}
}

#Charge Incantations (Cost 3)
country_event = {
	id = genie_cult.6
	title = genie_cult.6.t
	desc = genie_cult.6.d
	picture = RELIGIOUS_CONVERSION_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					NOT = { is_capital_of = ROOT }
					development = 11
				}
				save_event_target_as = emerald_splash_target
			}
			random_owned_province = {
				limit = {
					has_port = yes
				}
				save_event_target_as = restoration_of_fallen_crafts_target
			}
		}
	}

	option = {
		name = genie_cult.6.a
		trigger = {
			OR = {
				has_adopted_cult = jannu_cult
				has_adopted_cult = tanizuland_cult
			}
		}
		add_country_modifier = {
			name = perfection_of_home
			duration = 1825
		}
	}

	option = {
		name = genie_cult.6.b
		trigger = {
			OR = {
				has_adopted_cult = jannu_cult
				has_adopted_cult = tanizuland_cult
			}
		}
		if = {
			limit = { has_saved_event_target = emerald_splash_target }
			event_target:emerald_splash_target = {
				add_base_tax = -1
				add_base_production = -1
				add_base_manpower = -1
				random_list = {
					1 = {
						change_trade_goods = gems
					}
					19 = {
					}
				}
			}
			add_years_of_income = 0.5
		}
		else = {
			custom_tooltip = emeral_splash_tt
		}
	}

	option = {
		name = genie_cult.6.c
		trigger = {
			OR = {
				has_adopted_cult = naqi_cult
				has_adopted_cult = fidiya_cult
			}
		}
		add_country_modifier = {
			name = blaze_of_glory
			duration = 1825
		}
	}

	option = {
		name = genie_cult.6.dd
		trigger = {
			OR = {
				has_adopted_cult = naqi_cult
				has_adopted_cult = fidiya_cult
			}
		}
		custom_tooltip = fire_wall_tt
		every_owned_province = {
			limit = {
				has_fort_building_trigger = yes
			}
			add_province_modifier = {
				name = fire_wall
				duration = 1825
			}
		}
	}

	option = {
		name = genie_cult.6.e
		trigger = {
			OR = {
				has_adopted_cult = al_dimiryat_cult
				has_adopted_cult = grand_sultan_cult
			}
			manpower = 3
		}
		add_manpower = -3
		custom_tooltip = due_judgement_tt
		hidden_effect = {
			random_list = {
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = philosopher cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = natural_scientist cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = artist cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = treasurer cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = theologian cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = master_of_mint cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = inquisitor cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = statesman cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = naval_reformer cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = trader cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = spymaster cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = diplomat cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = navigator cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = army_reformer cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = army_organiser cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = commandant cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = quartermaster cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = recruitmaster cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = fortification_expert cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = grand_captain cost_multiplier = 0.25 }
				}
				1 = {
					generate_scaled_advisor_of_type_and_cost_effect = { type = court_mage cost_multiplier = 0.25 }
				}
			}
		}
		if = {
			limit = { government_rank = 2 }
			add_stability = 2
		}
		else = {
			add_stability = 1
		}
	}

	option = {
		name = genie_cult.6.f
		trigger = {
			OR = {
				has_adopted_cult = al_dimiryat_cult
				has_adopted_cult = grand_sultan_cult
			}
		}
		add_country_modifier = {
			name = holy_winds
			duration = 1825
		}
	}

	option = {
		name = genie_cult.6.g
		trigger = {
			OR = {
				has_adopted_cult = dakinshi_cult
				has_adopted_cult = vyzemby_cult
			}
			any_owned_province = {
				has_port = yes
			}
		}
		add_country_modifier = {
			name = restoration_of_fallen_crafts
			duration = 3650
		}
		event_target:restoration_of_fallen_crafts_target = {
			heavy_ship = ROOT
			heavy_ship = ROOT
			heavy_ship = ROOT
			heavy_ship = ROOT
			heavy_ship = ROOT
			heavy_ship = ROOT
			heavy_ship = ROOT
			heavy_ship = ROOT
			heavy_ship = ROOT
			heavy_ship = ROOT
		}
	}

	option = {
		name = genie_cult.6.h
		trigger = {
			OR = {
				has_adopted_cult = dakinshi_cult
				has_adopted_cult = vyzemby_cult
			}
		}
		if = {
			limit = {
				home_trade_node = {
					trade_share = {
						country = ROOT
						share = 80
					}
				}
			}
			add_country_modifier = {
				name = siren_chant_5
				duration = 1825
			}
		}
		else_if = {
			limit = {
				home_trade_node = {
					trade_share = {
						country = ROOT
						share = 60
					}
				}
			}
			add_country_modifier = {
				name = siren_chant_4
				duration = 1825
			}
		}
		else_if = {
			limit = {
				home_trade_node = {
					trade_share = {
						country = ROOT
						share = 40
					}
				}
			}
			add_country_modifier = {
				name = siren_chant_3
				duration = 1825
			}
		}
		else_if = {
			limit = {
				home_trade_node = {
					trade_share = {
						country = ROOT
						share = 20
					}
				}
			}
			add_country_modifier = {
				name = siren_chant_2
				duration = 1825
			}
		}
		else = {
			add_country_modifier = {
				name = siren_chant_1
				duration = 1825
			}
		}
	}

	option = {
		name = genie_cult.6.i
		country_event = {
			id = genie_cult.3
		}
	}
}

#Charge Incantations (Cost 4)
country_event = {
	id = genie_cult.7
	title = genie_cult.7.t
	desc = genie_cult.7.d
	picture = RELIGIOUS_CONVERSION_eventPicture
	
	is_triggered_only = yes

	option = {
		name = genie_cult.7.a
		trigger = {
			has_adopted_cult = vyzemby_cult
		}
		custom_tooltip = preservation_of_life_tt
		hidden_effect = {
			country_event = {
				id = genie_cult.8
				days = 365
			}
			country_event = {
				id = genie_cult.8
				days = 730
			}
			country_event = {
				id = genie_cult.8
				days = 1095
			}
			country_event = {
				id = genie_cult.8
				days = 1460
			}
			country_event = {
				id = genie_cult.8
				days = 1825
			}
		}
	}

	option = {
		name = genie_cult.7.b
		trigger = {
			has_adopted_cult = horasesh_cult
		}
		custom_tooltip = holy_buildings_tt
		set_country_flag = holy_buildings_active
		hidden_effect = {
			country_event = {
				id = genie_cult.9
				days = 1825
			}
		}
	}

	option = {
		name = genie_cult.7.c
		trigger = {
			has_adopted_cult = darbanar_cult
		}
		country_event = {
			id = genie_cult.10
		}
	}

	option = {
		name = genie_cult.7.dd
		trigger = {
			has_adopted_cult = dakinshi_cult
		}
		kill_ruler = yes
		add_stability = 1
		add_adm_power = 25
		add_dip_power = 25
		add_mil_power = 25
	}

	option = {
		name = genie_cult.7.e
		trigger = {
			has_adopted_cult = brasan_cult
		}
		custom_tooltip = renewed_emancipation_tt
		set_country_flag = renewed_emancipation_active
	}

	option = {
		name = genie_cult.7.f
		trigger = {
			has_adopted_cult = al_dimiryat_cult
		}
		custom_tooltip = making_of_a_king_tt
		if = {
			limit = { legitimacy = 80 }
			increase_ruler_adm_effect = yes
		}
		if = {
			limit = { diplomatic_reputation = 2 }
			increase_ruler_dip_effect = yes
		}
		if = {
			limit = { prestige = 80 }
			increase_ruler_mil_effect = yes
		}
	}

	option = {
		name = genie_cult.7.g
		trigger = {
			has_adopted_cult = jannu_cult
		}
		custom_tooltip = globetrotter_tt
	}

	option = {
		name = genie_cult.7.h
		trigger = {
			has_adopted_cult = tanizuland_cult
		}
		custom_tooltip = earthshaker_tt
		every_province = {
			limit = {
				sieged_by = ROOT
			}
			change_controller = ROOT
		}
	}

	option = {
		name = genie_cult.7.i
		trigger = {
			has_adopted_cult = fidiya_cult
		}
		custom_tooltip = divine_sandstorm_tt
		add_country_modifier = {
			name = divine_sandstorm_movement
			duration = 183
		}
		country_event = {
			id = genie_cult.11
			days = 183
		}
	}

	option = {
		name = genie_cult.7.j
		trigger = {
			has_adopted_cult = grand_sultan_cult
		}
		custom_tooltip = power_of_an_epitaph_tt
		add_ruler_modifier = {
			name = power_of_an_epitaph
		}
		set_ruler_flag = power_of_an_epitaph_flag
	}

	option = {
		name = genie_cult.7.k
		trigger = {
			has_adopted_cult = naqi_cult
		}
		add_country_modifier = {
			name = flaying_the_mind
			duration = 1825
		}
	}

	option = {
		name = genie_cult.7.l
		trigger = {
			has_adopted_cult = ardimya_cult
		}
		add_war_exhaustion = -20
		add_country_modifier = {
			name = ardimyan_rites
			duration = 5475
		}
	}

	option = {
		name = genie_cult.7.m
		country_event = {
			id = genie_cult.3
		}
	}
}

#Preservation Of Life
country_event = {
	id = genie_cult.8
	title = genie_cult.8.t
	desc = genie_cult.8.d
	picture = RELIGIOUS_CONVERSION_eventPicture
	
	is_triggered_only = yes

	option = {
		name = genie_cult.8.a
		add_manpower = 5
		add_sailors = 1000
	}
}

#Holy buildings removal
country_event = {
	id = genie_cult.9
	title = genie_cult.9.t
	desc = genie_cult.9.d
	picture = RELIGIOUS_CONVERSION_eventPicture
	
	hidden = yes
	is_triggered_only = yes

	option = {
		name = genie_cult.9.a
		clr_country_flag = holy_buildings_active
	}
}

#Red Bind
country_event = {
	id = genie_cult.10
	title = genie_cult.10.t
	desc = genie_cult.10.d
	picture = RELIGIOUS_CONVERSION_eventPicture
	
	is_triggered_only = yes

	option = {
		name = genie_cult.10.a
		custom_tooltip = red_bind_enemy_tt
		every_country = {
			limit = {
				war_with = ROOT
			}
			add_country_modifier = {
				name = red_bind
				duration = 90
			}
		}
		custom_tooltip = red_bind_scorched_bonus_tt
		hidden_effect = {
			set_variable = {
				which = scorched_counter
				value = 10
			}
			while = {
				limit = {
					any_owned_province = {
						has_province_modifier = scorched_earth
					}
					check_variable = {
						which = scorched_counter
						value = 1
					}
				}
				random_owned_province = {
					limit = {
						has_province_modifier = scorched_earth
						NOT = {
							has_province_modifier = red_bind_defender
						}
					}
					add_province_modifier = {
						name = red_bind_defender
						duration = 365
					}
				}
				subtract_variable = {
					which = scorched_counter
					value = 1
				}
			}
		}
	}
}

#Divine Sandstorm second effect
country_event = {
	id = genie_cult.11
	title = genie_cult.11.t
	desc = genie_cult.11.d
	picture = RELIGIOUS_CONVERSION_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			add_country_modifier = {
				name = divine_sandstorm_shock
				duration = 182
			}
		}
	}

	option = {
		name = genie_cult.11.a
		tooltip = {
			add_country_modifier = {
				name = divine_sandstorm_shock
				duration = 182
			}
		}
	}
}