
namespace = flavour_kherka

country_event = {
	id = flavour_kherka.1
	title = flavour_kherka.t
	desc = flavour_kherka.d
	picture = SWORD_OF_OSMAN_eventPicture
	
	fire_only_once = yes

	trigger = { tag = G48 }

    option  = {
        name = flavour_kherka.1.a
        lokemeion_area = {
            add_permanent_claim = ROOT
        }
        ormam_area = {
            add_permanent_claim = ROOT
        }
    }
}

#Election Stuff
country_event = { #Setting up the variable and calculating
	id = flavour_kherka.1000
	title = flavour_kherka.1000.t
	desc = flavour_kherka.1000.d
	picture = SHIP_SAILING_eventPicture

    is_triggered_only = yes 

    trigger = {}

    immediate = {
        set_variable = {
            which = clan_1
            value = 0
        }
        set_variable = {
            which = clan_2
            value = 0
        }
        set_variable = {
            which = clan_3
            value = 0
        }
        set_variable = {
            which = clan_4
            value = 0
        }
        set_variable = {
            which = clan_5
            value = 0
        }
        set_variable = {
            which = clan_6
            value = 0
        }
        set_variable = {
            which = clan_7
            value = 0
        }
        set_variable = {
            which = clan_8
            value = 0
        }
        set_variable = {
            which = clan_9
            value = 0
        }
        set_variable = {
            which = clan_10
            value = 0
        }
        set_variable = {
            which = highest_vote
            value = 0
        }
        set_variable = { #Maximum number of votes
            which = max_vote
            value = 50
        }
        while = {
            limit = {
                check_variable = {
                    which = max_vote
                    value = 1
                }
            }
            random_list = { #50 times randomly increasing a clan's vote
                1 = {
                    increase_random_clan_vote = { clan = clan_1 }
                    check_clan_winning = { clan = clan_1 }
                }
                1 = {
                    increase_random_clan_vote = { clan = clan_2 }
                    check_clan_winning = { clan = clan_2 }
                }
                1 = {
                    increase_random_clan_vote = { clan = clan_3 }
                    check_clan_winning = { clan = clan_3 }
                }
                1 = {
                    increase_random_clan_vote = { clan = clan_4 }
                    check_clan_winning = { clan = clan_4 }
                }
            }
        }
    }

    option = {
        name = flavour_kherka.1.a 
        country_event = { id = flavour_kherka.2 days= 30 }
    }
}

country_event = { #Displaying to the player the total votes
	id = flavour_kherka.2
	title = flavour_kherka.2.t
	desc = flavour_kherka.2.d
	picture = SHIP_SAILING_eventPicture

    is_triggered_only = yes 

    trigger = {}

    immediate = {
        hidden_effect = {
            if = {
                limit = {
                    is_variable_equal = {
                        which = highest_vote
                        which = clan_1
                    }
                }
                set_country_flag = clan_1_equal
            }
            if = {
                limit = {
                    is_variable_equal = {
                        which = highest_vote
                        which = clan_2
                    }
                }
                set_country_flag = clan_2_equal
            }
            if = {
                limit = {
                    is_variable_equal = {
                        which = highest_vote
                        which = clan_3
                    }
                }
                set_country_flag = clan_3_equal
            }
            if = {
                limit = {
                    is_variable_equal = {
                        which = highest_vote
                        which = clan_4
                    }
                }
                set_country_flag = clan_4_equal
            }
        }
    }

    # Option for Clan 1
    option = { 
        name = flavour_kherka.1.a
        hidden_trigger = {
            NOT = {
                calc_true_if = {
                    has_country_flag = clan_1_equal
                    has_country_flag = clan_2_equal
                    has_country_flag = clan_3_equal
                    has_country_flag = clan_4_equal
                    amount = 2
                }
            }
        }
        decrease_random_clan_option = { #Randomly decrease 1 vote from a clan, except for this
            clan_2 = yes 
            clan_3 = yes
            clan_4 = yes
            clan_5 = yes
            clan_6 = yes
            clan_7 = yes
            clan_8 = yes
            clan_9 = yes
            clan_10 = yes
        }
        increase_clan_vote = { clan = clan_1 }
        add_republican_tradition = -2
        check_clan_winning = { clan = clan_1 }
        country_event = { id = flavour_kherka.2 days = 1 }
    }
    
    # Option for Clan 2
    option = { 
        name = flavour_kherka.2.a
        decrease_random_clan_option = { 
            clan_1 = yes 
            clan_3 = yes
            clan_4 = yes
            clan_5 = yes
            clan_6 = yes
            clan_7 = yes
            clan_8 = yes
            clan_9 = yes
            clan_10 = yes
        }
        increase_clan_vote = { clan = clan_2 }
        add_republican_tradition = -2
        check_clan_winning = { clan = clan_2 }
        country_event = { id = flavour_kherka.2 days = 1 }
    }
    
    # Option for Clan 3
    option = { 
        name = flavour_kherka.3.a
        decrease_random_clan_option = { 
            clan_1 = yes 
            clan_2 = yes
            clan_4 = yes
            clan_5 = yes
            clan_6 = yes
            clan_7 = yes
            clan_8 = yes
            clan_9 = yes
            clan_10 = yes
        }
        increase_clan_vote = { clan = clan_3 }
        add_republican_tradition = -2
        check_clan_winning = { clan = clan_3 }
        country_event = { id = flavour_kherka.2 days = 1 }
    }
    
    # Option for Clan 4
    option = { 
        name = flavour_kherka.4.a
        decrease_random_clan_option = { 
            clan_1 = yes 
            clan_2 = yes
            clan_3 = yes
            clan_5 = yes
            clan_6 = yes
            clan_7 = yes
            clan_8 = yes
            clan_9 = yes
            clan_10 = yes
        }
        increase_clan_vote = { clan = clan_4 }
        add_republican_tradition = -2
        check_clan_winning = { clan = clan_4 }
        country_event = { id = flavour_kherka.2 days = 1 }
    }
    
    # Option for Clan 5
    option = { 
        name = flavour_kherka.5.a
        decrease_random_clan_option = { 
            clan_1 = yes 
            clan_2 = yes
            clan_3 = yes
            clan_4 = yes
            clan_6 = yes
            clan_7 = yes
            clan_8 = yes
            clan_9 = yes
            clan_10 = yes
        }
        increase_clan_vote = { clan = clan_5 }
        add_republican_tradition = -2
        check_clan_winning = { clan = clan_5 }
        country_event = { id = flavour_kherka.2 days = 1 }
    }
    
    # Option for Clan 6
    option = { 
        name = flavour_kherka.6.a
        decrease_random_clan_option = { 
            clan_1 = yes 
            clan_2 = yes
            clan_3 = yes
            clan_4 = yes
            clan_5 = yes
            clan_7 = yes
            clan_8 = yes
            clan_9 = yes
            clan_10 = yes
        }
        increase_clan_vote = { clan = clan_6 }
        add_republican_tradition = -2
        check_clan_winning = { clan = clan_6 }
        country_event = { id = flavour_kherka.2 days = 1 }
    }
    
    # Option for Clan 7
    option = { 
        name = flavour_kherka.7.a
        decrease_random_clan_option = { 
            clan_1 = yes 
            clan_2 = yes
            clan_3 = yes
            clan_4 = yes
            clan_5 = yes
            clan_6 = yes
            clan_8 = yes
            clan_9 = yes
            clan_10 = yes
        }
        increase_clan_vote = { clan = clan_7 }
        add_republican_tradition = -2
        check_clan_winning = { clan = clan_7 }
        country_event = { id = flavour_kherka.2 days = 1 }
    }
    
    # Option for Clan 8
    option = { 
        name = flavour_kherka.8.a
        decrease_random_clan_option = {
            clan_1 = yes 
            clan_2 = yes
            clan_3 = yes
            clan_4 = yes
            clan_5 = yes
            clan_6 = yes
            clan_7 = yes
            clan_9 = yes
            clan_10 = yes
        }
        increase_clan_vote = { clan = clan_8 }
        add_republican_tradition = -2
        check_clan_winning = { clan = clan_8 }
        country_event = { id = flavour_kherka.2 days = 1 }
    }
    
    # Option for Clan 9
    option = { 
        name = flavour_kherka.9.a
        decrease_random_clan_option = {
            clan_1 = yes 
            clan_2 = yes
            clan_3 = yes
            clan_4 = yes
            clan_5 = yes
            clan_6 = yes
            clan_7 = yes
            clan_8 = yes
            clan_10 = yes
        }
        increase_clan_vote = { clan = clan_9 }
        add_republican_tradition = -2
        check_clan_winning = { clan = clan_9 }
        country_event = { id = flavour_kherka.2 days = 1 }
    }
    
    # Option for Clan 10
    option = { 
        name = flavour_kherka.10.a
        decrease_random_clan_option = { 
            clan_1 = yes 
            clan_2 = yes
            clan_3 = yes
            clan_4 = yes
            clan_5 = yes
            clan_6 = yes
            clan_7 = yes
            clan_8 = yes
            clan_9 = yes
        }
        increase_clan_vote = { clan = clan_10 }
        add_republican_tradition = -2
        check_clan_winning = { clan = clan_10 }
        country_event = { id = flavour_kherka.2 days = 1 }
    }
    
}