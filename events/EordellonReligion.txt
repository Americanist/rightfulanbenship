namespace = eordellon

#Funereal Season Honoring
country_event = {
	id = eordellon.1
	title = eordellon.1.t
	desc = eordellon.1.d
	picture = KING_SICK_IN_BED_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			religion = eordellon
			religion = spring_court
			religion = summer_court
			religion = autumn_court
			religion = winter_court
		}
		capital_scope = { superregion = eordand_superregion }
		NOT = { has_ruler_flag = eordan_funeral_regency } #so it doesn't trigger for regency ending
		NOT = { government = republic }
	}
	
	immediate = {
		hidden_effect = {
			if = {
				limit = { has_regency = yes }
				set_heir_flag = eordan_funeral_regency
			}
		}
	}
	
	option = { #Spring
		name = eordellon.1.a
		trigger = {
			OR = {
				religion = eordellon
				accepted_culture = selphereg
				primary_culture = selphereg
			}
		}
		ai_chance = {
			factor = 100
			
			modifier = {
				factor = 10
				religion = spring_court
			}
		}
		add_adm_power = 10
	}
	option = { #Summer
		name = eordellon.1.b
		trigger = {
			OR = {
				religion = eordellon
				accepted_culture = caamas
				primary_culture = caamas
			}
		}
		ai_chance = {
			factor = 100
			
			modifier = {
				factor = 10
				religion = summer_court
			}
		}
		add_dip_power = 10
	}
	option = { #Autumn
		name = eordellon.1.c
		trigger = {
			OR = {
				religion = eordellon
				accepted_culture = tuathak
				primary_culture = tuathak
			}
		}
		ai_chance = {
			factor = 100
			
			modifier = {
				factor = 10
				religion = autumn_court
			}
		}
		add_mil_power = 10
	}
	option = { #Winter
		name = eordellon.1.dd
		trigger = {
			OR = {
				religion = eordellon
				accepted_culture = snecboth
				primary_culture = snecboth
			}
		}
		ai_chance = {
			factor = 100
			
			modifier = {
				factor = 10
				religion = winter_court
			}
		}
		increase_legitimacy_small_effect = yes
	}
	option = { #Precursor
		name = eordellon.1.e
		ai_chance = {
			factor = 100
			
			modifier = {
				factor = 2
				religion = eordellon
			}
		}
		add_prestige = 5
		add_years_of_income = -0.05
	}
	
}

country_event = { #Shift in Seasons
	id = eordellon.2
	title = eordellon.2.t
	desc = eordellon.2.d
	picture = STREET_SPEECH_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			religion = eordellon
			religion = spring_court
			religion = summer_court
			religion = autumn_court
			religion = winter_court
		}
	}
	mean_time_to_happen = {
		days = 1
	}
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = { 
					is_state = yes
					NOT = { is_capital = yes} 
				}
				save_event_target_as = fey_shift_seasons
				random_list = {
					20 = {
						trigger = { NOT = { religion = eordellon } }
						change_religion = eordellon
					}
					20 = {
						trigger = { NOT = { religion = spring_court } }
						change_religion = spring_court
					}
					20 = {
						trigger = { NOT = { religion = summer_court } }
						change_religion = summer_court
					}
					20 = {
						trigger = { NOT = { religion = autumn_court } }
						change_religion = autumn_court
					}
					20 = {
						trigger = { NOT = { religion = winter_court } }
						change_religion = winter_court
					}
				}
			}
			random_owned_province = {
				limit = { 
					is_state = yes
					NOT = { is_capital = yes} 
				}
				save_event_target_as = fey_shift_seasons
				random_list = {
					20 = {
						trigger = { NOT = { religion = eordellon } }
						change_religion = eordellon
					}
					20 = {
						trigger = { NOT = { religion = spring_court } }
						change_religion = spring_court
					}
					20 = {
						trigger = { NOT = { religion = summer_court } }
						change_religion = summer_court
					}
					20 = {
						trigger = { NOT = { religion = autumn_court } }
						change_religion = autumn_court
					}
					20 = {
						trigger = { NOT = { religion = winter_court } }
						change_religion = winter_court
					}
				}
			}
		}
	}
	
	option = {
		name = eordellon.2.a
		
		add_country_modifier = { name = "fey_alignment_shift_tolerance" duration = 3650 }
	}
	option = {
		name = eordellon.2.b
		
		if = {
			limit = { has_saved_event_target = fey_shift_seasons }
			event_target:fey_shift_seasons = {
				random_list = {
					30 = {
						spawn_rebels = {
							type = heretic_rebels
							size = 1
						}
					}
					70 = { }
				}
			}
		}
		add_country_modifier = { name = "fey_alignment_shift_convert" duration = 3650 }
	}
	
}


#Religious festival
country_event = {
	id = eordellon.3
	title = eordellon.3.t
	desc = eordellon.3.d
	picture = FEAST_eventPicture
	
	is_triggered_only = yes
	
	immediate = { hidden_effect = {
		#Seasonal combo
		#Spring
		if = {
			limit = {
				religion = spring_court
				NOT = {
					AND = {
						has_country_flag = seasonal_adm_neutral_aspect
						has_country_flag = seasonal_dip_neutral_aspect
						has_country_flag = seasonal_mil_neutral_aspect
					}
				}
				OR = {
					has_country_flag = seasonal_adm_neutral_aspect
					has_country_flag = seasonal_adm_spring_aspect
				}
				OR = {
					has_country_flag = seasonal_dip_neutral_aspect
					has_country_flag = seasonal_dip_spring_aspect
				}
				OR = {
					has_country_flag = seasonal_mil_neutral_aspect
					has_country_flag = seasonal_mil_spring_aspect
				}
			}
			#Spring Combo
		}
		#summer
		if = {
			limit = {
				religion = summer_court
				NOT = {
					AND = {
						has_country_flag = seasonal_adm_neutral_aspect
						has_country_flag = seasonal_dip_neutral_aspect
						has_country_flag = seasonal_mil_neutral_aspect
					}
				}
				OR = {
					has_country_flag = seasonal_adm_neutral_aspect
					has_country_flag = seasonal_adm_summer_aspect
				}
				OR = {
					has_country_flag = seasonal_dip_neutral_aspect
					has_country_flag = seasonal_dip_summer_aspect
				}
				OR = {
					has_country_flag = seasonal_mil_neutral_aspect
					has_country_flag = seasonal_mil_summer_aspect
				}
			}
			#summer Combo
		}
		#autumn 
		if = {
			limit = {
				religion = autumn_court
				NOT = {
					AND = {
						has_country_flag = seasonal_adm_neutral_aspect
						has_country_flag = seasonal_dip_neutral_aspect
						has_country_flag = seasonal_mil_neutral_aspect
					}
				}
				OR = {
					has_country_flag = seasonal_adm_neutral_aspect
					has_country_flag = seasonal_adm_autumn_aspect
				}
				OR = {
					has_country_flag = seasonal_dip_neutral_aspect
					has_country_flag = seasonal_dip_autumn_aspect
				}
				OR = {
					has_country_flag = seasonal_mil_neutral_aspect
					has_country_flag = seasonal_mil_autumn_aspect
				}
			}
			#autumn Combo
		}
		#Winter
		if = {
			limit = {
				religion = winter_court
				NOT = {
					AND = {
						has_country_flag = seasonal_adm_neutral_aspect
						has_country_flag = seasonal_dip_neutral_aspect
						has_country_flag = seasonal_mil_neutral_aspect
					}
				}
				OR = {
					has_country_flag = seasonal_adm_neutral_aspect
					has_country_flag = seasonal_adm_winter_aspect
				}
				OR = {
					has_country_flag = seasonal_dip_neutral_aspect
					has_country_flag = seasonal_dip_winter_aspect
				}
				OR = {
					has_country_flag = seasonal_mil_neutral_aspect
					has_country_flag = seasonal_mil_winter_aspect
				}
			}
			#winter Combo
		}
		#Eordellon combos
		#Spring
		if = {
			limit = {
				religion = eordellon
				OR = {
					has_country_flag = seasonal_adm_winter_aspect
					has_country_flag = seasonal_dip_winter_aspect
					has_country_flag = seasonal_adm_winter_aspect
				}
				OR = {
					has_country_flag = seasonal_adm_summer_aspect
					has_country_flag = seasonal_dip_summer_aspect
					has_country_flag = seasonal_adm_summer_aspect
				}
				OR = {
					has_country_flag = seasonal_adm_autumn_aspect
					has_country_flag = seasonal_dip_autumn_aspect
					has_country_flag = seasonal_adm_autumn_aspect
				}
			}
			#spring eordellon
		}
		#Summer
		if = {
			limit = {
				religion = eordellon
				OR = {
					has_country_flag = seasonal_adm_winter_aspect
					has_country_flag = seasonal_dip_winter_aspect
					has_country_flag = seasonal_adm_winter_aspect
				}
				OR = {
					has_country_flag = seasonal_adm_spring_aspect
					has_country_flag = seasonal_dip_spring_aspect
					has_country_flag = seasonal_adm_spring_aspect
				}
				OR = {
					has_country_flag = seasonal_adm_autumn_aspect
					has_country_flag = seasonal_dip_autumn_aspect
					has_country_flag = seasonal_adm_autumn_aspect
				}
			}
			#summer eordellon
		}
		#Autumn
		if = {
			limit = {
				religion = eordellon
				OR = {
					has_country_flag = seasonal_adm_winter_aspect
					has_country_flag = seasonal_dip_winter_aspect
					has_country_flag = seasonal_adm_winter_aspect
				}
				OR = {
					has_country_flag = seasonal_adm_spring_aspect
					has_country_flag = seasonal_dip_spring_aspect
					has_country_flag = seasonal_adm_spring_aspect
				}
				OR = {
					has_country_flag = seasonal_adm_summer_aspect
					has_country_flag = seasonal_dip_summer_aspect
					has_country_flag = seasonal_adm_summer_aspect
				}
			}
			#autumn eordellon
		}
		#Winter
		if = {
			limit = {
				religion = eordellon
				OR = {
					has_country_flag = seasonal_adm_autumn_aspect
					has_country_flag = seasonal_dip_autumn_aspect
					has_country_flag = seasonal_adm_autumn_aspect
				}
				OR = {
					has_country_flag = seasonal_adm_spring_aspect
					has_country_flag = seasonal_dip_spring_aspect
					has_country_flag = seasonal_adm_spring_aspect
				}
				OR = {
					has_country_flag = seasonal_adm_summer_aspect
					has_country_flag = seasonal_dip_summer_aspect
					has_country_flag = seasonal_adm_summer_aspect
				}
			}
			#winter eordellon
		}
		#Individual aspect stuff
	}}
	
	after = {
		clear_country_flag = seasonal_adm_spring_aspect
		clear_country_flag = seasonal_adm_summer_aspect
		clear_country_flag = seasonal_adm_autumn_aspect
		clear_country_flag = seasonal_adm_winter_aspect
		clear_country_flag = seasonal_adm_neutral_aspect
		clear_country_flag = seasonal_adm_eordellon_aspect
		clear_country_flag = seasonal_dip_spring_aspect
		clear_country_flag = seasonal_dip_summer_aspect
		clear_country_flag = seasonal_dip_autumn_aspect
		clear_country_flag = seasonal_dip_winter_aspect
		clear_country_flag = seasonal_dip_neutral_aspect
		clear_country_flag = seasonal_dip_eordellon_aspect
		clear_country_flag = seasonal_mil_spring_aspect
		clear_country_flag = seasonal_mil_summer_aspect
		clear_country_flag = seasonal_mil_autumn_aspect
		clear_country_flag = seasonal_mil_winter_aspect
		clear_country_flag = seasonal_mil_neutral_aspect
		clear_country_flag = seasonal_mil_eordellon_aspect
		
		remove_church_aspect = random
		remove_church_aspect = random
		remove_church_aspect = random
	}
	
	option = {
		name = eordellon.3.a
	}
}
#Mission menu
country_event = {
	id = eordellon.4
	title = eordellon.4.t
	desc = eordellon.4.d
	picture = BLANK_eventPicture
	
	is_triggered_only = yes
	
	
	option = {
		potential = {
			NOT = { has_country_flag = seasonal_objective_one }
			NOT = { current_income_balance = 50 }
		}
		name = eordellon.4.a
		country_event = {
			id = eordellon.4
			days = 1
		}
	}
	option = {
		highlight = yes
		potential = {
			NOT = { has_country_flag = seasonal_objective_one }
			current_income_balance = 50
		}
		name = eordellon.4.b
		add_treasury = -50
		upgrade_seasonal_court_level = yes
		set_country_flag = seasonal_objective_one
	}
	option = {
		potential = {
			NOT = { has_country_flag = seasonal_objective_two }
			OR = {
				2049 = {
					NOT = { owned_by = ROOT }
				}
				exist = H08
			}
		}
		goto = 2049
		name = eordellon.4.c
		country_event = {
			id = eordellon.4
			days = 1
		}
	}
	option = {
		highlight = yes
		potential = {
			NOT = { has_country_flag = seasonal_objective_two }
			NOT = { exist = H08 }
			2049 = {
				owned_by = ROOT
			}
		}
		name = eordellon.4.d
		upgrade_seasonal_court_level = yes
		set_country_flag = seasonal_objective_two
	}
	option = {
		name = eordellon.4.e
	}
	option = {
		name = eordellon.4.exit
	}
	
}
#Start up event
country_event = {
	id = eordellon.5
	title = eordellon.5.t
	desc = eordellon.5.d
	picture = BLANK_eventPicture
	
	is_triggered_only = yes
	trigger = {
		OR = {
			religion = eordellon
			religion = spring_court
			religion = summer_court
			religion = autumn_court
			religion = winter_court
		}
	}
	
	immediate = {
		hidden_effect = {
			add_country_modifier = { 
				name = seasonal_court_level_zero
				duration = -1  
			}
			if = {
				limit = { religion = eordellon }
				set_country_flag = eordellon_influencer_unlocked
			}
			else_if = {
				limit = { religion = spring_court }
				set_country_flag = spring_influencer_unlocked
			}
			else_if = {
				limit = { religion = summer_court }
				set_country_flag = summer_influencer_unlocked
			}
			else_if = {
				limit = { religion = autumn_court }
				set_country_flag = autumn_influencer_unlocked
			}
			else_if = {
				limit = { religion = winter_court }
				set_country_flag = winter_influencer_unlocked
			}
			if = {
				limit = { tag = H08 }
				set_country_flag = seasonal_objective_two
				upgrade_seasonal_court_level = yes
			}
		}
	}	
	option = {
		name = eordellon.5.a
	}
}