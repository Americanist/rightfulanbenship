namespace = racial_pop_misc

country_event = {	#Scapegoats
	id = racial_pop_misc.5
	title = racial_pop_misc.5.t
	desc = racial_pop_misc.5.d
	picture = BAD_WITH_MONARCH_eventPicture
	is_triggered_only = yes
	trigger = {
		OR = {
			has_country_modifier = just_lost_war_timer
			average_unrest = 10
			is_bankrupt = yes
		}
		is_not_purging_or_expelling_any_race_trigger = yes
		any_owned_province = { has_minority_trigger = yes }
	}
	immediate = {
		hidden_effect = {
			save_random_present_race_as_flag_effect = { scripted_trigger = generic_has_non_integrated_minority_trigger flag = propflag1 }
			save_random_present_race_as_flag_effect = { scripted_trigger = generic_has_non_integrated_minority_trigger flag = propflag2 flag2 = propflag1 }
		}
	}

	option = {
		name = racial_pop_misc.5.1
		trigger = { NOT = { ruler_has_personality = cruel_personality }	}
		reduce_stability_or_adm_power = yes
		add_prestige = -10
	}

	option = {
		name = racial_pop_misc.5.2
		trigger = {
			NOT = {
				ruler_has_personality = just_personality
				ruler_has_personality = kind_hearted_personality
			}
			any_owned_province = {
				OR = {
					has_any_coexisting_minority_trigger = yes
					has_any_oppressed_minority_trigger = yes
				}
			}	
		}
		effect_for_random_race = { flag = propflag1 scripted_effect = racial_pop_misc_5_effect }
	}

	option = {
		name = racial_pop_misc.5.3
		trigger = {
			NOT = {
				ruler_has_personality = just_personality
				ruler_has_personality = kind_hearted_personality
			}
			any_owned_province = {
				OR = {
					has_any_coexisting_minority_trigger = yes
					has_any_oppressed_minority_trigger = yes
				}
			}
			has_country_flag = random_race_selected2			
		}
		effect_for_random_race = { flag = propflag2 scripted_effect = racial_pop_misc_5_effect }
	}

	option = {
		name = racial_pop_misc.5.4
		trigger = { 
			all_owned_province = {
				has_any_coexisting_minority_trigger = no
				has_any_oppressed_minority_trigger = no
			}
		}
		add_stability_or_adm_power = yes
	}

	after = {
		clear_random_race_flag = { flag = propflag1 flag2 = proprflag2 }
	}
}

country_event = {	#Tragedy Strikes!
	id = racial_pop_misc.6
	title = racial_pop_misc.6.t
	desc = racial_pop_misc.6.d
	picture = WOUNDED_SOLDIERS_eventPicture
	is_triggered_only = yes
	trigger = { 
		any_owned_province = { has_province_flag = mob_province }
	}
	
	immediate = {
		random_owned_province = { 
			limit = { has_province_flag = mob_province }
			hidden_effect = { save_event_target_as = mob_province }
		}
	}

	option = {
		name = racial_pop_misc.6.1		
		goto = mob_province		
		effect_for_random_race = { flag = mob scripted_effect = racial_pop_misc_6_effect }
		clear_random_race_flag = { flag = mob }
	}
}

country_event = {
	id = racial_pop_misc.7	#An Additional Tax?
	title = racial_pop_misc.7.t
	desc = racial_pop_misc.7.d
	picture = WOUNDED_SOLDIERS_eventPicture #temp one, change
	is_triggered_only = yes
	trigger = {
		has_wartaxes = yes
		is_in_deficit = yes
		any_owned_province = { has_minority_trigger = yes }
	}

	immediate = {
		hidden_effect = {
			save_random_present_race_as_flag_effect = { scripted_trigger = generic_has_any_pop_trigger flag = wt1 }
			save_random_present_race_as_flag_effect = { scripted_trigger = generic_has_any_pop_trigger flag = wt2 flag2 = wt1 }
		}
		effect_for_random_race = { flag = wt1 scripted_effect = racial_pop_misc_7_effect effectargument = varname argumentvalue = wtvariable_a }
		effect_for_random_race = { flag = wt2 scripted_effect = racial_pop_misc_7_effect effectargument = varname argumentvalue = wtvariable_b }
	}

	option = {
		name = racial_pop_misc.7.1
		effect_for_random_race = { flag = wt1 scripted_effect = racial_pop_misc_7_2_effect effectargument = varname argumentvalue = wtvariable_a }
	}

	option = {
		name = racial_pop_misc.7.2
		trigger = { has_country_flag = random_race_selected2 }
		effect_for_random_race = { flag = wt2 scripted_effect = racial_pop_misc_7_2_effect effectargument = varname argumentvalue = wtvariable_b }
	}

	option = {
		name = racial_pop_misc.7.3
		add_prestige = 5
	}

	after = {
		clear_random_race_flag = { flag = wt1 flag2 = wt2 }
	}
}

country_event = {
	id = racial_pop_misc.8	#Send Smallfolks to Aelantir
	title = racial_pop_misc.8.t
	desc = racial_pop_misc.8.d
	picture = WOUNDED_SOLDIERS_eventPicture #temp one, change
	is_triggered_only = yes
	trigger = {
		any_owned_province = { is_colony = yes }
		any_owned_province = {
			OR = {
				culture_is_goblin = yes
				culture_is_halfling = yes
				culture_is_kobold = yes
			}
		}
	}

	immediate = {
		hidden_effect = {
			random_list = {
				1 = {
					trigger = {
						any_owned_province = { culture_is_goblin = yes }
					}
					random_owned_province = {
						limit = { culture_is_goblin = yes }
						save_event_target_as = goblin_origin
					}
				}
				1 = {
					trigger = {
						any_owned_province = { culture_is_halfling = yes }
					}
					random_owned_province = {
						limit = { culture_is_halfling = yes }
						save_event_target_as = halfling_origin
					}
				}
				1 = {
					trigger = {
						any_owned_province = { culture_is_kobold = yes }
					}
					random_owned_province = {
						limit = { culture_is_kobold = yes }
						save_event_target_as = kobold_origin
					}
				}
			}
			random_owned_province = {
				limit = { is_colony = yes }
				save_event_target_as = settlers_destinations
			}
		}
	}

	option = {
		name = racial_pop_misc.8.1
		goto = settlers_destinations
		add_treasury = -50
		if = {
			limit = { has_saved_event_target = goblin_origin }
			racial_pop_misc_8_effect = { race = goblin }
		}
		else_if = {
			limit = { has_saved_event_target = halfling_origin }
			racial_pop_misc_8_effect = { race = halfling }
		}
		else = {
			racial_pop_misc_8_effect = { race = kobold }
		}
	}

	option = {
		name = racial_pop_misc.8.2
		goto = settlers_destinations
		if = {
			limit = { has_saved_event_target = goblin_origin }
			racial_pop_misc_8_effect = { race = goblin }
			medium_decrease_of_goblin_tolerance_effect = yes
		}
		else_if = {
			limit = { has_saved_event_target = halfling_origin }
			racial_pop_misc_8_effect = { race = halfling }
			medium_decrease_of_halfling_tolerance_effect = yes
		}
		else = {
			racial_pop_misc_8_effect = { race = kobold }
			medium_decrease_of_kobold_tolerance_effect = yes
		}
	}
}