

namespace = flavor_stalbor

#Dynasty Naming
country_event = {
	id = flavor_stalbor.1
	title = dynasty_setup.1.t
	desc = dynasty_setup.1.d
	picture = {
		trigger = {
			NOT = { has_dlc = "Rights of Man" }
		}
		picture = COURT_eventPicture
	}
	picture = {
		trigger = {
			has_dlc = "Rights of Man"
		}
		picture = ROYAL_COUPLE_FUTURE_eventPicture
	}
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		tag = B47
	}
	
	#Option A
	option = {		
		name = "flavor_stalbor.1.a"
		ai_chance = { factor = 40 }	
		define_heir = {
			dynasty = "síl Stalbór"
			age = 16
			male = yes
			change_adm = 1
			change_dip = 1
			change_mil = 1
			hide_skills = yes
		}
	}
	
	#Option B
	option = {		
		name = "flavor_stalbor.1.b"
		ai_chance = { factor = 40 }	
		define_heir = {
			dynasty = "Stal"
			age = 16
			male = yes
			change_adm = 1
			change_dip = 1
			change_mil = 1
			hide_skills = yes
		}
	}
	
	#Keep their name
	option = {		
		name = "flavor_stalbor.1.c"
		ai_chance = { factor = 20 }	
		define_heir = {
			dynasty = ROOT
			age = 16
			male = yes
			change_adm = 1
			change_dip = 1
			change_mil = 1
			hide_skills = yes
		}
	}
}

province_event = {
	id = flavor_stalbor.2
	title = flavor_stalbor.2.t
	desc = flavor_stalbor.2.d
	picture = {
		trigger = {
			NOT = { has_dlc = "Rights of Man" }
		}
		picture = COURT_eventPicture
	}
	picture = {
		trigger = {
			has_dlc = "Rights of Man"
		}
		picture = ROYAL_COUPLE_FUTURE_eventPicture
	}
	
	is_triggered_only = yes
	
	trigger = {
		
	}
	
	immediate = {
		owner = {
			hidden_effect = {
				set_country_flag = arturo_meny_open
			}
		}
	}

	#Admin
	option = {		
		name = "flavor_stalbor.2.a"
		ai_chance = { factor = 30 }	
		remove_province_modifier = arturos_watch_chapter
		add_permanent_province_modifier = {
			name = arturos_adm_branch
			duration = -1
		}
	}
	
	#Military
	option = {		
		name = "flavor_stalbor.2.b"
		ai_chance = { factor = 30 }	
		remove_province_modifier = arturos_watch_chapter
		add_permanent_province_modifier = {
			name = arturos_mil_branch
			duration = -1
		}
	}
	
	#Naval
	option = {		
		name = "flavor_stalbor.2.b"
		trigger = {
			has_port = yes
		}
		ai_chance = { factor = 40 }	
		remove_province_modifier = arturos_watch_chapter
		add_permanent_province_modifier = {
			name = arturos_naval_branch
			duration = -1
		}
	}

	#Back
	option = {		
		name = "flavor_stalbor.2.e"
		ai_chance = { factor = 0 }
	}

	after = {
		owner = {
			hidden_effect = {
				clr_country_flag = arturo_meny_open
			}
		}
	}
}

#Founding Event
country_event = {
	id = flavor_stalbor.3
	title = flavor_stalbor.3.t
	desc = flavor_stalbor.3.d
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		tag = B47
	}
	
	#Basic Setup
	option = {		
		name = "flavor_stalbor.3.a"
		ai_chance = { factor = 100 }	
		#### Remove this!!!
		add_country_modifier = {
			name = temp_mod_to_remove
			duration = -1
		}
		forlorn_vale_region = {
			discover_country = ROOT
		}
		####
		random_owned_province = {
			add_orcish_minority_size_effect = yes
			add_goblin_minority_size_effect = yes
		}
		random_owned_province = {
			add_orcish_minority_size_effect = yes
			add_goblin_minority_size_effect = yes
		}
		vernham_area = {
			limit = { NOT = { owned_by = ROOT } }
			add_permanent_claim = ROOT
		}
		oudeben_area = {
			limit = { NOT = { owned_by = ROOT } }
			add_permanent_claim = ROOT
		}
		clovenwood_area = {
			limit = { NOT = { owned_by = ROOT } }
			add_permanent_claim = ROOT
		}
	}
}

country_event = {
	id = flavor_stalbor.4
	title = flavor_stalbor.4.t
	desc = flavor_stalbor.4.d
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	#Basic Setup
	option = {		
		name = "flavor_stalbor.4.a"
		ai_chance = { factor = 0 }	
		817 = {
			add_permanent_province_modifier = {
				name = arturos_watch_chapter
				duration = -1
			}
			change_trade_goods = livestock
		}
		set_country_flag = book_of_stone_unlocked
	}

	option = {		
		name = "flavor_stalbor.4.b"
		ai_chance = { factor = 100 }	
		817 = {
			add_permanent_province_modifier = {
				name = arturos_watch_chapter
				duration = -1
			}
			change_trade_goods = livestock
		}
		set_country_flag = book_of_stone_unlocked
		add_government_reform = book_of_stone
	}

}

country_event = {
	id = flavor_stalbor.5
	title = flavor_stalbor.5.t
	desc = flavor_stalbor.5.d
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		OR = {
			tag = B47
			was_tag = B47
		}
	}
	
	#Ignore the rebels
	option = {		
		name = "flavor_stalbor.5.a"
		ai_chance = { factor = 50 }	
		817 = {
			spawn_rebels = {
				type = noble_rebels
				size = 3
				leader = "Elrac of Dustandar"
			}
		}
		hidden_effect = {
			country_event = {
				id = flavor_stalbor.7
				days = 7
			}
		}
	}	
	
	#Become Blademarches
	option = {
		name = "flavor_stalbor.5.a"
		ai_chance = {factor = 50}
		
		if = {
			limit = { has_reform = adventurer_reform }
			set_country_flag = adventurer_derived_government
			tooltip = {
				adventurer_legacy_effect = yes
				country_event = { id = flavor_blademarches.1 days = 1 }
#					country_event = { id = adventurer.2 days = 1 }
			}
		}
		change_tag = B33
		if = {
			limit = { OR = { has_reform = adventurer_reform has_country_flag = adventurer_derived_government } }
			adventurer_legacy_effect = yes
			country_event = { id = flavor_blademarches.1 days = 1 }
#				country_event = { id = adventurer.2 days = 1 }
		}
		if = {
			limit = {
				has_country_modifier = human_administration
			}
			custom_tooltip = tooltip_marcher_culture_provinces
			hidden_effect = {
				every_owned_province = {
					limit = {
						has_owner_culture = yes
						owner = {
							culture_is_human = yes
						}
					}
					change_culture = marcher
				}
			}
		}
		if = {
			limit = {
				has_country_modifier = human_administration
			}
			change_primary_culture = marcher
			
		}
		set_country_flag = feudal_escann_kingdom
		set_country_flag = no_formable_culture_shift
		hidden_effect = { restore_country_name = yes }
		remove_non_electors_emperors_from_empire_effect = yes
		if = {
			limit = { NOT = { government = monarchy } }
			change_government = monarchy
		}
		add_government_reform = blademarches_kingdom_reform
		define_ruler = {
			name = "Elrac"
			dynasty = "of Dustandar"
			culture = half_orc
			religion = ROOT
			adm = 3
			dip = 4
			mil = 6
			fixed = yes
			age = 34
			claim = 50
		}
		hidden = {
			clear_fast_ruler_flags = yes
			set_ruler_flag = half_orcish_ruler
			remove_heir = {}
			remove_consort = yes
		}
		if = {
			limit = {
				NOT = { government_rank = 2 }
			}
			set_government_rank = 2
		}
		add_prestige = 25
		set_country_flag = formed_blademarches_flag
		clr_country_flag = 	knightly_order_adventurer
		if = {
			limit = { has_custom_ideas = no }
			country_event = { id = ideagroups.1 } #Swap Ideas
		}
		country_event = { id = flavor_blademarches.2 days = 5 }
		swap_non_generic_missions = yes
	}
}

country_event = {
	id = flavor_stalbor.6
	title = flavor_stalbor.6.t
	desc = flavor_stalbor.6.d
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	#We Have the Sword
	option = {		
		name = "flavor_stalbor.6.a"
		ai_chance = { factor = 100 }	
		add_country_modifier = {
			name = stewards_of_calindal
			duration = -1
		}
	}
}

country_event = {
	id = flavor_stalbor.7
	title = flavor_stalbor.7.t
	desc = flavor_stalbor.7.d
	
	is_triggered_only = yes
	hidden = yes
	
	trigger = {
		always = yes
	}
	
	option = {		
		name = "flavor_stalbor.7.a"
		ai_chance = { factor = 1 }	
		country_event = {
			id = flavor_stalbor.7
			days = 7
		}
	}
	option = {		
		name = "flavor_stalbor.7.a"
		ai_chance = { factor = 99 }	
		trigger = {
			ROOT = {
				NOT = {
					num_of_rebel_armies = 1
				}
			}
		}
		country_event = {
			id = flavor_stalbor.6
			days = 1
		}
	}
}

country_event = {
	id = flavor_stalbor.8
	title = flavor_stalbor.8.t
	desc = flavor_stalbor.8.d
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	#Wood Elf Vassalization
	option = {		
		name = "flavor_stalbor.8.a"
		ai_chance = { factor = 100 }
		FROM = {
			vassalize = I27
		}
		change_religion = FROM
		west_deepwoods_region = {
			type = all
            add_permanent_claim = ROOT
		}
		add_country_modifier = {
			name = B47_religious_turmoil
			duration = 9125
		}
		add_country_modifier = {
			name = B47_deepwoods_accord_I
			duration = -1
		}
	}

	option = {
		name = "flavor_stalbor.8.b"
		ai_chance = { factor = 0 }	
		FROM = {
			declare_war_with_cb = {
				who = ROOT
				casus_belli = cb_vassalize_mission
			}
		}
		west_deepwoods_region = {
			type = all
            add_permanent_claim = ROOT
		}
		add_country_modifier = {
			name = B47_religious_turmoil
			duration = 9125
		}
		add_country_modifier = {
			name = B47_deepwoods_accord_I
			duration = -1
		}
	}
}

country_event = {
	id = flavor_stalbor.9
	title = flavor_stalbor.9.t
	desc = flavor_stalbor.9.d
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	#Integrate the Dargom
	option = {	
		name = "flavor_stalbor.9.a"
		ai_chance = { factor = 50 }
		random_owned_province = {
			limit = {
				OR = {
					has_orcish_majority_trigger = yes
					has_orcish_minority_trigger = yes
				}
			}
			spawn_rebels = {
				type = leadered_peasant_rebels
				size = 1
			}
		}
		random_owned_province = {
			limit = {
				OR = {
					has_orcish_majority_trigger = yes
					has_orcish_minority_trigger = yes
				}
			}
			spawn_rebels = {
				type = leadered_peasant_rebels
				size = 1
			}
		}
		random_owned_province = {
			limit = {
				OR = {
					has_orcish_majority_trigger = yes
					has_orcish_minority_trigger = yes
				}
			}
			spawn_rebels = {
				type = leadered_peasant_rebels
				size = 1
			}
		}
		add_country_modifier = {
			name = B47_dargom_generals
			duration = -1
		}
	}

	#Dismantling the Ozdan
	option = {
		name = "flavor_stalbor.9.b"
		ai_chance = { factor = 50 }	
		capital_scope = {
			spawn_rebels = {
				type = noble_rebels
				size = 3
			}
		}
		add_country_modifier = {
			name = B47_ozdan_shock_troops
			duration = -1
		}
	}
}

country_event = {
	id = flavor_stalbor.10
	title = flavor_stalbor.10.t
	desc = flavor_stalbor.10.d
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	#Last Pocket's of Resistance
	option = {	
		name = "flavor_stalbor.10.a"
		ai_chance = { factor = 100 }
		I27 = {
			random_owned_province = {
				limit = {
					culture_is_orcish = yes
				}
				spawn_rebels = {
					type = great_dookan_rebels
					size = 2
				}
			}
			random_owned_province = {
				limit = {
					culture_is_elven = yes
				}
				spawn_rebels = {
					type = fey_court_rebels
					size = 2
				}
			}
			random_owned_province = {
				limit = {
					culture_is_goblin = yes
				}
				spawn_rebels = {
					type = goblinic_shamanism_rebels
					size = 2
				}
			}
		}
		country_event = {
			id = flavor_stalbor.11
			days = 7
		}
	}
}

country_event = {
	id = flavor_stalbor.11
	title = flavor_stalbor.11.t
	desc = flavor_stalbor.11.d
	
	is_triggered_only = yes
	hidden = yes
	
	trigger = {
		always = yes
	}
	
	option = {		
		name = "flavor_stalbor.11.a"
		ai_chance = { factor = 1 }	
		country_event = {
			id = flavor_stalbor.11
			days = 7
		}
	}
	option = {		
		name = "flavor_stalbor.11.a"
		ai_chance = { factor = 99 }	
		trigger = {
			I27 = {
				NOT = {
					num_of_rebel_armies = 1
				}
			}
			I27 = {
				NOT = {
					num_of_rebel_controlled_provinces = 1
				}
			}
		}
		country_event = {
			id = flavor_stalbor.12
			days = 1
		}
	}
}

country_event = {
	id = flavor_stalbor.12
	title = flavor_stalbor.12.t
	desc = flavor_stalbor.12.d
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	#The Matter of the Deepwoods
	option = {	
		name = "flavor_stalbor.12.a"
		ai_chance = { factor = 100 }
		I27 = {
			remove_country_modifier = B47_religious_turmoil
			remove_country_modifier = B47_deepwoods_accord_I
			add_country_modifier = {
				name = B47_deepwoods_accord_II
				duration = -1
			}
		}
		set_country_flag = B47_the_matters_of_the_deepwoods_event
	}
}

country_event = {
	id = flavor_stalbor.12
	title = flavor_stalbor.12.t
	desc = flavor_stalbor.12.d
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	#Vernham
	option = {	
		name = "flavor_stalbor.12.a"
		ai_chance = { factor = 100 }
		#Fuck This
	}
	#Castonath
	option = {	
		name = "flavor_stalbor.12.a"
		ai_chance = { factor = 100 }
		inner_castanor_region = {
			type = all
            add_permanent_claim = ROOT
		}
	}

}