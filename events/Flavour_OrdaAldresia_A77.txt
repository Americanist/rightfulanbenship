

namespace = flavor_orda_aldresia

# Convert to Ravelian and change name to Order of St. Aldresia
country_event = {
	id = flavor_orda_aldresia.1
	title = flavor_orda_aldresia.1.t
	desc = flavor_orda_aldresia.1.d
	picture = wihgfx_FEMALE_GENERAL_eventPicture
	
	fire_only_once = yes
	major = yes

	trigger = {
		tag = A77
		is_religion_enabled = ravelian
	}
	
	mean_time_to_happen = {
		months = 100

		modifier = {
			factor = 0.1
			religion = ravelian
		}
	}
	
	option = {		
		name = flavor_orda_aldresia.1.a
		trigger = {
			religion = ravelian
		}
		ai_chance = { factor = 50 }
		
		if = {
			limit = { has_reform = secular_order_reform }
			add_government_reform = monastic_order_reform
		}

		add_prestige = 100
		add_stability = 1
		add_devotion = 100

		add_historical_friend = Z97
		Z97 = { add_historical_friend = A77 }

		override_country_name = ORDER_OF_ST_ALDRESIA
	}
	
	option = {		
		name = flavor_orda_aldresia.1.b
		trigger = {
			NOT = { religion = ravelian }
		}
		ai_chance = { factor = 50 }

		change_religion = ravelian
		
		if = {
			limit = { has_reform = secular_order_reform }
			add_government_reform = monastic_order_reform
		}
		
		add_prestige = 50
		add_stability = 1
		add_devotion = 100

		add_historical_friend = Z97
		Z97 = { add_historical_friend = A77 }

		override_country_name = ORDER_OF_ST_ALDRESIA
	}
}

#Start Event - Imperial Bodyguard Vassal Choice
country_event = { #Lothane Wex demands Subjugation from Orda Aldresia
	id = flavor_orda_aldresia.2
	title = flavor_orda_aldresia.2.t
	desc = flavor_orda_aldresia.2.d
	picture = LILAC_WARS_eventPicture

	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		tag = A77
		NOT = { is_year = 1445 }
	}

	option = { #become imperial bodyguard
		name = flavor_orda_aldresia.2.a
		ai_chance = {
			factor = 1
		}
		custom_tooltip = flavor_orda_aldresia.2.a.tt
		add_country_modifier = {
			name = memory_of_skylance
			duration = 3650
		}
		add_country_modifier = {
			name = sentinels_of_the_usurper
			duration = 3650
		}
		emperor = {
			add_country_modifier = {
				name = supporting_orda_aldresia
				duration = -1
			}
		}
	}
}


country_event = { #	Orda Aldresia religion conflict
	id = flavor_orda_aldresia.3
	title = flavor_orda_aldresia.3.t
	desc = flavor_orda_aldresia.3.d
	picture = hussite_RELIGION_eventPicture

	fire_only_once = yes
	major = yes

	trigger = {
		tag = A77
		hre_size = 1	# has_matching_religion = emperor and war_with = emperor crash the game if there is no emperor, and also seem to sometimes be run before hre_size = 1!
		emperor = { 	# thus, do the triggers the other way for safety
			NOT = { has_matching_religion = ROOT }
		}
	}

	option = { # Reject Imperial Demand to Convert
		name = flavor_orda_aldresia.3.a
		ai_chance = {
			factor = 0.8
		}

		overlord = {
			add_trust = {
				who = A77
				value = -100
			}
			add_opinion = {
				who = A77
				modifier = forsaken_oath
			}
			every_subject_country = {
				limit = { tag = A77 }
				grant_independence = yes	
			}
			add_casus_belli = {
				target = A77
				type = cb_force_ancient_oath
				months = 120
			}
		}
		set_country_flag = broken_oath		
	}

	option = { # Stay loyal
		name = flavor_orda_aldresia.3.b
		ai_chance = {
			factor = 0.2
		}
		emperor = {
			A77 = {
				change_religion = PREV
			}
		}
	}
}


country_event = { #If Empire is dead for any reason, OA Vassal breaks
	id = flavor_orda_aldresia.4
	title = flavor_orda_aldresia.4.t
	desc = flavor_orda_aldresia.4.d
	picture = LILAC_WARS_eventPicture

	fire_only_once = yes

	trigger = {
		tag = A77
		is_subject_of_type = imperial_bodyguard
		NOT = { hre_size = 1 }
	}

	option = { #End of the Empire
		name = flavor_orda_aldresia.4.a
		ai_chance = {
			factor = 1
		}
		grant_independence = yes
	}
}


country_event = { #	hidden edge case event if Orda Aldresia breaks alliance for war 
	id = flavor_orda_aldresia.5
	title = flavor_orda_aldresia.5.t
	desc = flavor_orda_aldresia.5.d
	picture = hussite_RELIGION_eventPicture

	hidden = yes

    trigger = {
        tag = A77
        hre_size = 1
        emperor = {				#game crashes if this is the other way around, see flavor_orda_aldresia.3
            has_matching_religion = ROOT
            war_with = ROOT
        }
        NOT = { has_country_flag = broken_oath}
    }

	option = { # Reject Imperial Demand to Convert
		name = flavor_orda_aldresia.5.a
		ai_chance = {
			factor = 1
		}
		A77 = {
			white_peace = emperor
		}
		emperor = {
			create_subject = {
				subject_type = imperial_bodyguard
				subject = A77
			}
		}
	}
}


#Orda MT Events

country_event = { #Orda is Collapsing Start Event
	id = flavor_orda_aldresia.7
	title = flavor_orda_aldresia.7.t
	desc = flavor_orda_aldresia.7.d
	picture = CASTLE_eventPicture

	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		tag = A77
		NOT = { is_year = 1445 }
	}

	option = { #An Orda Divided
		name = flavor_orda_aldresia.7.a
		ai_chance = {
			factor = 1
		}
		set_variable = {
			which = orda_war_wins
			value = 0
		}
		set_variable = {
			which = orda_emperor_war
			value = 0
		}
		define_ruler = {
			name = "Aldresian Senior Council"
			regency = {
					estate = estate_nobles
				}
			adm = 1
			dip = 1
			mil = 1
		}
		set_country_flag = noble_coup
		add_stability = -1
		add_country_modifier = { 
			name = decade_of_warring_blades
			duration = -1
		}
		extend_regency = 100
	}
}

country_event = { # The Greentide Generation
	id = flavor_orda_aldresia.8
	title = flavor_orda_aldresia.8.t
	desc = flavor_orda_aldresia.8.d
	picture = TOURNAMENT_eventPicture

	fire_only_once = yes
	is_triggered_only = yes

	option = { #Stay Steadfast to Traditions
		name = flavor_orda_aldresia.8.a
		ai_chance = {
			factor = 0.5
		}
		add_country_modifier = {
			name = angered_young_knights
			duration = 240
		}
		add_country_modifier = {
			name = steadfast_traditions
			duration = -1
		}
		add_estate_loyalty_modifier = {
			estate = estate_nobles
			desc = empowered_second_sons
			loyalty = 10
			duration = 240
		}
		add_estate_influence_modifier = {
			estate = estate_nobles
			desc = influential_second_sons
			duration = 240
			influence = 15
		}
	}

	option = { #Reform the Order's Promotion System
		name = flavor_orda_aldresia.8.b
		ai_chance = {
			factor = 0.5
		}
		add_country_modifier = {
			name = angered_old_order
			duration = 240
		}
		add_country_modifier = {
			name = reformed_promotion_system
			duration = -1
		}
		add_estate_loyalty_modifier = {
			estate = estate_adventurers
			desc = empowered_errants
			loyalty = 10
			duration = 240
		}
		add_estate_influence_modifier = {
			estate = estate_adventurers
			desc = influential_errants
			duration = 240
			influence = 15
		}
	}
}


country_event = { #The Magister and The Grandmaster
	id = flavor_orda_aldresia.9
	title = flavor_orda_aldresia.9.t
	desc = flavor_orda_aldresia.9.d
	picture = CASTLE_eventPicture

	fire_only_once = yes
	is_triggered_only = yes


	option = { #High Road
		name = flavor_orda_aldresia.9.a
		ai_chance = {
			factor = 0.33
		}
		add_country_modifier = {
			name = turn_the_cheek
			duration = 240
		}
		random_list = {
			50 = { 
				every_known_country = {
					limit = {is_elector = yes}
					add_opinion = {
						who = A85
						modifier = unbecoming_mages
					}
				}
			}
			50 = { }
		}
	}

	option = { #Stay Alert
		name = flavor_orda_aldresia.9.b
		ai_chance = {
			factor = 0.33
		}
		add_country_modifier = {
			name = wary_aldresians
			duration = 240
		}
		every_known_country = {
			limit = { alliance_with = A85}
			A85 = {
				add_favors = {
					who = PREV
					amount = 10
				}
			}
		}
		random_known_country = {
			limit = { alliance_with = A77}
			A77 = {
				add_favors = {
					who = PREV
					amount = 10
				}
			}
		}
	}

	option = { #If they go low, we kick em
		name = flavor_orda_aldresia.9.c
		ai_chance = {
			factor = 0.33
		}
		add_country_modifier = {
			name = spicy_aldresians
			duration = 240
		}
		random_list = {
			50 = { 
				random_known_country = {
					limit = {is_elector = yes}
					add_opinion = {
						who = A77
						modifier = unbecoming_knights
					}
				}
			}
			50 = { }
		}
	}
}

country_event = { #The Oath of Orda Aldresia
	id = flavor_orda_aldresia.10
	title = flavor_orda_aldresia.10.t
	desc = flavor_orda_aldresia.10.d
	picture = KNIGHTS_eventPicture

	fire_only_once = yes
	is_triggered_only = yes


	option = { #The Palace is secure?
		name = flavor_orda_aldresia.10.a
		custom_tooltip = surprise_ambush_tt
		hidden_effect = {
			emperor = {
				capital_scope = {
					spawn_rebels = {
						type = pretender_rebels
						leader = "Ser Atlas"
						size = 1
					}
				}
			}
		}
		if = {
			limit = { NOT = { is_year = 1454 } }
			country_event = { id = flavor_orda_aldresia.11 }
			
		} 
	}
}

country_event = { #Delian the Loyal
	id = flavor_orda_aldresia.11
	title = flavor_orda_aldresia.11.t
	desc = flavor_orda_aldresia.11.d
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes
	is_triggered_only = yes


	option = { #Till my light extinguishes
		name = flavor_orda_aldresia.11.a
		ai_chance = {
			factor = 1
		}
		clr_country_flag = noble_coup
		remove_country_modifier = decade_of_warring_blades
		set_country_flag = delian_tries
		add_prestige = 10
		add_legitimacy = 10
		define_ruler = {
			name = "Delian"
			dynasty = "sil Arannen"
			age = 68
			adm = 5
			dip = 2
			mil = 4
			
		}
		hidden_effect = {
			add_ruler_personality = lawgiver_personality
			add_ruler_personality = careful_personality
			add_ruler_personality = mage_personality
		}
	}
}


country_event = { #Delian's Death
	id = flavor_orda_aldresia.12
	title = flavor_orda_aldresia.12.t
	desc = flavor_orda_aldresia.12.d
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes
	is_triggered_only = yes


	option = { #Till my light extinguishes
		name = flavor_orda_aldresia.12.a
		ai_chance = {
			factor = 1
		}
		clr_country_flag = noble_coup
		remove_country_modifier = decade_of_warring_blades
		add_prestige = 10
		add_legitimacy = 10
		if = {
			limit = { 
				NOT = { has_country_flag = delian_tries}
			}
			define_ruler = {
				name = "Castana"
				dynasty = "sil Hardwick"
				age = 25
				adm = 5
				dip = 4
				mil = 3
			}
			hidden_effect = {
				add_ruler_personality = lawgiver_personality
				add_ruler_personality = reformist_personality
				add_ruler_personality = mage_personality
			}
		}
	}
}


country_event = { #Ascendancy of Castana sil Hardwick
	id = flavor_orda_aldresia.13
	title = flavor_orda_aldresia.13.t
	desc = flavor_orda_aldresia.13.d
	picture = GOOD_WITH_MONARCH_eventPicture

	#fire_only_once = yes
	is_triggered_only = yes

	option = { #I serve the realm, not one man
		name = flavor_orda_aldresia.13.a
		ai_chance = {
			factor = 1
		}
	}
}


country_event = { #Storming of Oldtower
	id = flavor_orda_aldresia.14
	title = flavor_orda_aldresia.14.t
	desc = flavor_orda_aldresia.14.d
	picture = SIEGE_PRAGUE_CASTLE_eventPicture

	fire_only_once = yes
	is_triggered_only = yes


	option = { #Sieze Old Tower
		name = flavor_orda_aldresia.14.a
		ai_chance = {
			factor = 1
		}
		add_dip_power = 200
		add_adm_power = 200
		add_mil_power = 200
		add_prestige = 50
		331 = {
			cede_province = A77
		}
	}
}

country_event = { #Incident at Ebrosfield
	id = flavor_orda_aldresia.15
	title = flavor_orda_aldresia.15.t
	desc = flavor_orda_aldresia.15.d
	picture = BYZ_BAD_WITH_MONARCH_eventPicture

	fire_only_once = yes
	is_triggered_only = yes

	option = { #Investigate with diligence
		name = flavor_orda_aldresia.15.a
		ai_chance = {
			factor = 0.33
		}
		add_country_modifier = {
			name = dilligent_spies
			duration = 5475
		}
		hidden_effect = {
			423 = {
				spawn_rebels = {
					type = vampires_nobles
					leader = "Lord Gehrman"
					size = 2
				}
			}
			
		}
	}
	option = { #Prepare for War
		name = flavor_orda_aldresia.15.b
		ai_chance = {
			factor = 0.33
		}
		add_country_modifier = {
			name = prepare_for_war
			duration = 5475
		}
		hidden_effect = {
			423 = {
				spawn_rebels = {
					type = vampires_nobles
					leader = "Lord Gehrman"
					size = 2
				}
			}
		}
	}
	option = { #Invest in advanced weaponry
		name = flavor_orda_aldresia.15.c
		ai_chance = {
			factor = 0.33
		}
		add_country_modifier = {
			name = advanced_solutions
			duration = 5475
		}
		hidden_effect = {
			423 = {
				spawn_rebels = {
					type = vampires_nobles
					leader = "Lord Gehrman"
					size = 2
				}
			}
		}
	}
}


country_event = { #Raid of the Magisterium's Vault
	id = flavor_orda_aldresia.16
	title = flavor_orda_aldresia.16.t
	desc = flavor_orda_aldresia.16.d
	picture = END_OF_TIME_eventPicture

	fire_only_once = yes
	is_triggered_only = yes

	option = { #Holy Avenger
		name = flavor_orda_aldresia.16.a
		ai_chance = {
			factor = 0.33
		}
		add_country_modifier = {
			name = holy_avenger
			duration = -1
		}
	}
	option = { #Robe of the Archmagi
		name = flavor_orda_aldresia.16.b
		ai_chance = {
			factor = 0.33
		}
		add_country_modifier = {
			name = robe_of_the_archmagi
			duration = -1
		}
		
	}
	option = { #A Holy Hand Grenade
		name = flavor_orda_aldresia.16.c
		ai_chance = {
			factor = 0.33
		}
		add_country_modifier = {
			name = holy_hand_grenade
			duration = -1
		}
		
	}
}

country_event = { #Search for Aldresia's Sword
	id = flavor_orda_aldresia.17
	title = flavor_orda_aldresia.17.t
	desc = flavor_orda_aldresia.17.d
	picture = SWORD_OF_OSMAN_eventPicture

	fire_only_once = yes
	is_triggered_only = yes

	option = { #Aldresia's Sword
		name = flavor_orda_aldresia.17.a
		ai_chance = {
			factor = 1
		}
		add_country_modifier = {
			name = aldresias_sword
			duration = -1
		}
	}
}





